<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß - ‡∏ù‡∏∂‡∏Å‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;800;900&display=swap');
        * { box-sizing: border-box; }
        body {
            margin: 0; font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #a8e6cf 0%, #dcedc1 100%);
            height: 100vh; color: #333; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }
        .container { width: 100%; max-width: 480px; padding: 15px; position: relative; }
        #backToMenu {
            position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.4);
            padding: 8px 20px; border: none; border-radius: 50px; color: #333; font-weight: 600;
            font-size: 1rem; cursor: pointer; backdrop-filter: blur(12px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2); z-index: 1000; transition: all 0.3s;
        }
        #backToMenu:hover { background: rgba(255,255,255,0.6); }
        #levelSelect { text-align: center; }
        h1 { font-size: 3.2rem; margin: 0 0 10px; text-shadow: 0 4px 15px rgba(0,0,0,0.2); color: #d32f2f; }
        .subtitle { font-size: 1.4rem; margin-bottom: 20px; color: #444; }
        .friendly-msg {
            font-size: 1.6rem; font-weight: 700;
            color: #e91e63; margin: 20px 0 40px;
            text-shadow: 0 2px 8px rgba(233,30,99,0.3);
        }
        .start-btn {
            width: 80%; max-width: 320px; padding: 24px; font-size: 2.2rem; font-weight: 900;
            border: none; border-radius: 50px; cursor: pointer;
            background: #ffca28; color: #333; box-shadow: 0 12px 30px rgba(0,0,0,0.25);
            transition: all 0.3s;
        }
        .start-btn:hover { transform: translateY(-8px) scale(1.06); background: #ffd54f; }

        #game { display: none; text-align: center; position: relative; }
        .question-heading {
            font-size: 2.4rem; font-weight: 900; margin: 30px 20px 20px;
            padding: 20px; background: rgba(255,255,255,0.55);
            border-radius: 30px; backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15); color: #c2185b;
        }
        .typing-display {
            font-size: 4.2rem; font-weight: bold; min-height: 130px;
            margin: 30px 20px; color: #d81b60;
            background: rgba(255,255,255,0.45); padding: 30px; border-radius: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15); line-height: 1.3;
        }
        #typedByPlayer {
            font-size: 1.9rem; color: #ad1457; margin: 20px 20px 50px;
            min-height: 2.6rem; font-weight: 600;
        }
        #speakCue {
            position: absolute; bottom: 100px; left: 50%; transform: translateX(-50%);
            font-size: 4rem; opacity: 0; pointer-events: none;
            transition: opacity 0.4s ease; text-shadow: 0 0 20px #ffeb3b;
            z-index: 5;
        }
        #speakCue.show { opacity: 1; }

        #voiceInputBtn {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            padding: 14px 28px; font-size: 1.7rem; background: #4CAF50; color: white;
            border: none; border-radius: 50px; cursor: pointer;
            box-shadow: 0 6px 18px rgba(0,0,0,0.25); transition: all 0.3s;
        }
        #voiceInputBtn:hover { background: #43A047; transform: translate(-50%, -6px); }

        #success-celebration, #fail-celebration {
            position: absolute; inset: 0; pointer-events: none;
            display: flex; align-items: center; justify-content: center;
            font-size: 7rem; opacity: 0; transform: scale(0.5);
            transition: all 0.7s ease-out; z-index: 10;
        }
        #success-celebration.show { opacity: 0.95; transform: scale(1.5) rotate(8deg); }
        #fail-celebration { color: #e74c3c; }
        #fail-celebration.show { opacity: 0.92; transform: scale(1.4) rotate(-8deg); }

        #result { display: none; text-align: center; padding: 20px; }
        #result h2 { font-size: 3.6rem; margin: 30px 0 20px; color: #c2185b; }
        #resultMsg { font-size: 2.1rem; line-height: 1.6; margin: 30px 0; color: #444; }
        #score { font-size: 4.8rem; font-weight: 900; margin: 30px 0; color: #e91e63; }
        .btn-restart {
            padding: 18px 60px; font-size: 1.9rem; background: #ffca28;
            border: none; border-radius: 50px; color: #333; cursor: pointer;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); font-weight: 700;
        }
        .btn-restart:hover { transform: translateY(-6px); background: #ffd54f; }

        #question-live { position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden; }
    </style>
</head>
<body>

<div class="container">
    <button id="backToMenu">‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>

    <div id="levelSelect">
        <h1>‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß</h1>
        <p class="subtitle">‡∏ù‡∏∂‡∏Å‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πä‡∏∞!<br>‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÇ‡∏ú‡∏•‡πà‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÄ‡∏•‡∏¢‡∏ô‡∏∞</p>
        <p class="friendly-msg">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∂‡∏¢‡∏±‡∏á? ‡∏°‡∏≤‡πÑ‡∏•‡πà‡∏•‡πà‡∏≤‡∏Ñ‡∏≥‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏Å‡∏±‡∏ô!</p>
        <button class="start-btn" id="startGame">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
    </div>

    <div id="game">
        <div id="success-celebration">üéâüê∂üê±‚ú®</div>
        <div id="fail-celebration">‚ùåüòø</div>
        <div id="speakCue">üó£Ô∏è ‡∏û‡∏π‡∏î‡πÄ‡∏•‡∏¢!</div>

        <h2 class="question-heading" id="question">‡∏Ç‡πâ‡∏≠ 1 : ...</h2>
        <div class="typing-display" id="typingDisplay">_ _ _ _ _ _ _ _</div>
        <div id="typedByPlayer">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ : -</div>
        <button id="voiceInputBtn">‡∏û‡∏π‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
    </div>

    <div id="question-live" aria-live="polite" aria-atomic="true"></div>

    <div id="result">
        <h2 id="resultTitle">‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡πÄ‡∏•‡∏¢!</h2>
        <div id="resultMsg"></div>
        <div id="score">0 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
        <button class="btn-restart" id="restartBtn">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
    </div>
</div>

<script>
const syllables = ["‡πÑ‡∏Å‡πà","‡∏Å‡∏≤","‡πÅ‡∏Å‡∏∞","‡∏Å‡∏ö","‡∏´‡∏°‡∏π","‡∏´‡∏°‡∏≤","‡πÅ‡∏°‡∏ß","‡∏´‡∏°‡∏µ"];

const encourages = {
    perfect: [
        "‡πÇ‡∏Ñ‡∏ï‡∏£‡πÄ‡∏õ‡πä‡∏∞! ‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß üê∂üê±üê∑",
        "‡∏û‡∏π‡∏î‡πÄ‡∏õ‡πä‡∏∞‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≥ ‡∏™‡∏°‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏ä‡∏≤‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ ‚ú®",
        "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏à‡∏≥‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏Å üèÜ"
    ],
    great: [
        "‡πÄ‡∏Å‡πà‡∏á‡∏™‡∏∏‡∏î ‡πÜ ‡πÄ‡∏•‡∏¢! ‡πÑ‡∏•‡πà‡∏à‡∏±‡∏ö‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß üêæ",
        "‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏≠‡∏á‡∏ö‡∏±‡∏•‡∏•‡∏±‡∏á‡∏Å‡πå‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß‡πÅ‡∏ô‡πà! üî•",
        "‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏≥‡πÄ‡∏•‡∏¢ ‡∏™‡∏π‡πâ ‡πÜ ‡∏ô‡∏∞ üê∑üê∂"
    ],
    good: [
        "‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏ß‡πÄ‡∏•‡∏¢! ‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß‡∏¢‡∏±‡∏á‡∏ß‡∏¥‡πà‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡πÄ‡∏£‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà ‡∏Æ‡πà‡∏≤ ‡πÜ üòÑ",
        "‡∏™‡∏ô‡∏∏‡∏Å‡∏î‡∏µ‡πÄ‡∏ô‡∏≠‡∏∞ ‡∏°‡∏≤‡πÑ‡∏•‡πà‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏Å‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÑ‡∏´‡∏° üê±",
        "‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô üí™"
    ],
    normal: [
        "‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£ ‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß‡∏°‡∏±‡∏ô‡∏ã‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏°‡∏≤‡∏•‡∏∏‡∏¢‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏±‡∏ô! üê∂",
        "‡∏¢‡∏±‡∏á‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ù‡∏∂‡∏Å‡∏≠‡∏µ‡∏Å‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏•‡∏¢ ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ‡∏ô‡∏∞ üê∑",
        "‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢‡πÄ‡∏ô‡∏≠‡∏∞ ‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞ üò∏"
    ]
};

let currentQuestions = [];
let currentQ = 0;
let score = 0;
let recognition = null;
let isListening = false;
let isProcessing = false;

const audioEngine = {
    ctx: null,
    buffers: {},
    sounds: {
        correct: "https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-reward-952.mp3",
        wrong:   "https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-946.mp3",
        speak:   "https://assets.mixkit.co/sfx/preview/mixkit-cartoon-quick-bite-2106.mp3" // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡πá‡πÑ‡∏î‡πâ
    },
    async init() { /* ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡∏¢‡∏á ‡πÉ‡∏´‡πâ implement ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å‡∏Å‡πá‡πÑ‡∏î‡πâ */ },
    async play() {} // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ
};

function shuffle(array) {
    const a = [...array];
    for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
}

function generateNoRepeatSequence(length) {
    if (length < 1) return "";
    let seq = [syllables[Math.floor(Math.random() * syllables.length)]];
    while (seq.length < length) {
        let candidate;
        do {
            candidate = syllables[Math.floor(Math.random() * syllables.length)];
        } while (candidate === seq[seq.length - 1]);
        seq.push(candidate);
    }
    return seq.join("");
}

function generateQuestions() {
    const rounds = [
        { start: 1,  end: 3,  len: 4,  pts: 100  },
        { start: 4,  end: 6,  len: 5,  pts: 200  },
        { start: 7,  end: 9,  len: 6,  pts: 400  },
        { start:10, end:12,  len: 7,  pts: 800  },
        { start:13, end:15,  len: 8,  pts: 1600 },
        { start:16, end:20,  len:10,  pts: 3200 }
    ];

    const q = [];
    for (let r = 1; r <= 20; r++) {
        let cfg = rounds.find(b => r >= b.start && r <= b.end);
        if (!cfg) cfg = rounds[rounds.length-1]; // fallback
        const word = generateNoRepeatSequence(cfg.len);
        q.push({
            answer: word,
            hint:   word,        // hint = answer ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏π‡∏î‡∏ï‡∏≤‡∏°
            points: cfg.pts
        });
    }
    return q;
}

document.addEventListener('DOMContentLoaded', () => {
    const backBtn       = document.getElementById('backToMenu');
    const levelSelect   = document.getElementById('levelSelect');
    const gameDiv       = document.getElementById('game');
    const resultDiv     = document.getElementById('result');
    const questionElem  = document.getElementById('question');
    const typingDisplay = document.getElementById('typingDisplay');
    const typedByPlayer = document.getElementById('typedByPlayer');
    const questionLive  = document.getElementById('question-live');
    const startBtn      = document.getElementById('startGame');
    const restartBtn    = document.getElementById('restartBtn');
    const voiceBtn      = document.getElementById('voiceInputBtn');

    // Speech Recognition
    if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
        const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SR();
        recognition.lang = 'th-TH';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.onstart = () => { isListening = true; };
        recognition.onend   = () => { isListening = false; };

        recognition.onresult = (event) => {
            isListening = false;
            let transcript = event.results[0][0].transcript || "";
            // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏ó‡∏¢ + ‡∏ß‡∏£‡∏£‡∏ì‡∏¢‡∏∏‡∏Å‡∏ï‡πå + ‡∏™‡∏£‡∏∞ (‡∏ï‡∏±‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ)
            let cleaned = transcript.replace(/[^\u0E00-\u0E7F]/g, '');
            typingDisplay.textContent = cleaned;
            typedByPlayer.textContent = '‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ : ' + (cleaned || "(‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô)");

            if (cleaned === currentQuestions[currentQ].answer) {
                showCelebration('success');
                score += currentQuestions[currentQ].points;
                currentQ++;
                setTimeout(nextQuestion, 900);
            } else {
                showCelebration('fail');
                currentQ++;
                setTimeout(nextQuestion, 900);
            }
        };

        recognition.onerror = () => {
            isListening = false;
            if (!isProcessing) {
                showCelebration('fail');
                currentQ++;
                setTimeout(nextQuestion, 900);
            }
        };
    }

    function showCelebration(type) {
        const el = document.getElementById(type + '-celebration');
        el.classList.add('show');
        setTimeout(() => el.classList.remove('show'), 800);
    }

    function nextQuestion() {
        if (currentQ >= 20) {
            endGame();
            return;
        }

        isProcessing = false;
        const item = currentQuestions[currentQ];
        questionElem.textContent = `‡∏Ç‡πâ‡∏≠ ${currentQ + 1} : ${item.hint}`;
        typingDisplay.textContent = item.hint.split('').map(c => (c === ' ' ? ' ' : '_')).join(' ');
        typedByPlayer.textContent = "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ : -";

        questionLive.textContent = '';
        setTimeout(() => {
            questionLive.textContent = questionElem.textContent;
        }, 100);

        // ‡πÅ‡∏™‡∏î‡∏á cue ‡∏û‡∏π‡∏î
        setTimeout(() => {
            const cue = document.getElementById('speakCue');
            cue.classList.add('show');
            setTimeout(() => {
                cue.classList.remove('show');
                startVoice();
            }, 1200);
        }, 800);
    }

    function startVoice() {
        if (!recognition) {
            typedByPlayer.textContent = "(‡πÄ‡∏ö‡∏£‡∏≤‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î)";
            return;
        }
        try {
            recognition.stop();
        } catch(e){}
        setTimeout(() => {
            try {
                recognition.start();
            } catch(e){}
        }, 300);
    }

    function startGame() {
        currentQuestions = generateQuestions();
        currentQ = 0;
        score = 0;

        levelSelect.style.display = 'none';
        gameDiv.style.display = 'block';
        backBtn.style.display = 'none';
        nextQuestion();
    }

    function endGame() {
        gameDiv.style.display = 'none';
        resultDiv.style.display = 'block';
        backBtn.style.display = 'block';

        const title = document.getElementById('resultTitle');
        const msg   = document.getElementById('resultMsg');
        const sc    = document.getElementById('score');

        sc.textContent = score.toLocaleString() + " ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô";

        if (score >= 3200 * 5) { // ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö/‡πÄ‡∏ï‡πá‡∏° max (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏¢‡∏≠‡∏∞)
            title.textContent = "‡∏£‡∏≤‡∏ä‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏´‡∏°‡∏π‡∏´‡∏°‡∏≤‡πÅ‡∏°‡∏ß!";
            msg.innerHTML = encourages.perfect[Math.floor(Math.random()*encourages.perfect.length)];
        } else if (score >= 20000) {
            title.textContent = "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡∏°‡∏≤‡∏Å!";
            msg.innerHTML = encourages.great[Math.floor(Math.random()*encourages.great.length)];
        } else if (score >= 8000) {
            title.textContent = "‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢!";
            msg.innerHTML = encourages.good[Math.floor(Math.random()*encourages.good.length)];
        } else {
            title.textContent = "‡∏™‡∏π‡πâ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏∞!";
            msg.innerHTML = encourages.normal[Math.floor(Math.random()*encourages.normal.length)];
        }

        setTimeout(() => title.focus(), 100);
    }

    // Events
    startBtn.onclick   = startGame;
    restartBtn.onclick = () => {
        resultDiv.style.display = 'none';
        levelSelect.style.display = 'block';
        backBtn.style.display = 'block';
    };

    backBtn.onclick = () => {
        location.href = '../index.html'; // ‡∏´‡∏£‡∏∑‡∏≠ path ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    };

    voiceBtn.onclick = startVoice;
});
</script>
</body>
</html>