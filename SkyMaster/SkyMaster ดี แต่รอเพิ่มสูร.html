<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ศึกจ้าวเวหา - Sky Master</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: #4ade80; /* Green 400 */
            overflow-x: hidden;
        }
        
        .font-mono {
            font-family: 'Share Tech Mono', monospace;
        }

        /* Scanline effect */
        .scanlines::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* HUD Glow */
        .hud-text-shadow {
            text-shadow: 0 0 5px rgba(74, 222, 128, 0.5);
        }

        .hud-border-glow {
            box-shadow: 0 0 10px rgba(74, 222, 128, 0.2);
        }

        .crt-flicker {
            animation: flicker 0.15s infinite;
        }

        @keyframes flicker {
            0% { opacity: 0.97; }
            50% { opacity: 1; }
            100% { opacity: 0.98; }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Custom Toast Notification */
        #toast {
            visibility: hidden;
            min-width: 250px;
            background-color: #166534;
            color: #fff;
            text-align: center;
            border-radius: 4px;
            padding: 16px;
            position: fixed;
            z-index: 50;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-size: 17px;
            border: 1px solid #4ade80;
            box-shadow: 0 0 10px rgba(74, 222, 128, 0.5);
        }

        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }

        @keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }

        /* Hide Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a; 
        }
        ::-webkit-scrollbar-thumb {
            background: #15803d; 
            border-radius: 4px;
        }
    </style>
</head>
<body class="min-h-screen relative scanlines">

    <!-- App Container -->
    <div id="app" class="relative z-10 min-h-screen flex flex-col">
        <!-- Content will be injected here by JavaScript -->
    </div>
    
    <!-- Toast Notification Element -->
    <div id="toast">คัดลอกโค้ดสำเร็จ!</div>

    <script>
        // --- GAME DATA ---
        const GAME_DATA = [
          {
            level: 1,
            title: "การฝึกฝนและลาดตระเวน (Training & Patrol)",
            missions: [
              {
                text: "คุณกำลังลาดตระเวนเหนือน่านฟ้าข้าศึก พบเครื่องบินสอดแนมรุ่นเก่า 1 ลำบินช้าๆ อยู่ด้านหน้า",
                enemyAction: "ข้าศึกยังไม่รู้ตัวและบินเป็นเส้นตรง",
                options: [
                  { label: "เร่งเครื่องพุ่งเข้าไปยิงระยะเผาขน", correct: false, deathMsg: "คุณเข้าไปใกล้เกินไป เศษซากเครื่องข้าศึกระเบิดใส่เครื่องคุณจนพังพินาศ" },
                  { label: "ล็อกเป้าด้วยขีปนาวุธระยะไกลแล้วยิงทันที", correct: true },
                  { label: "บินตีคู่ไปเทียบข้างเพื่อข่มขู่", correct: false, deathMsg: "ป้อมปืนท้ายของข้าศึกยิงสวนเจาะห้องนักบินคุณทันที" },
                  { label: "วิทยุแจ้งฐานทัพให้ส่งคนอื่นมาจัดการ", correct: false, deathMsg: "ข้าศึกไหวตัวทันและหนีไปได้ ภารกิจล้มเหลว โดนสั่งขังลืม" }
                ]
              },
              {
                text: "หลังจัดการลำแรก เครื่องคุ้มกันข้าศึก 2 ลำ โผล่มาจากด้านหลังซ้ายและขวา!",
                enemyAction: "ข้าศึกยิงจรวดใส่คุณจากสองทิศทางพร้อมกัน",
                options: [
                  { label: "หักเลี้ยวซ้ายทันที", correct: false, deathMsg: "คุณเลี้ยวไปรับจรวดทางซ้ายเต็มๆ" },
                  { label: "ดึงหัวขึ้นตั้งฉาก 90 องศา (Vertical Climb)", correct: true },
                  { label: "เบรคกลางอากาศ", correct: false, deathMsg: "ความเร็วตกเป็นเป้านิ่ง โดนปืนกลกราดยิงพรุน" },
                  { label: "บินมุดลงพื้น", correct: false, deathMsg: "จรวดติดตามความร้อนพุ่งตามลงมาชนคุณโหม่งโลก" }
                ]
              },
              {
                text: "คุณอยู่เหนือเมฆ ข้าศึกไล่ตามมาติดๆ 1 ลำ พยายามล็อกเป้าคุณ",
                enemyAction: "สัญญาณเตือน Missile Lock ดังลั่นห้องนักบิน",
                options: [
                  { label: "บินส่ายไปมาแบบไร้ทิศทาง", correct: false, deathMsg: "สลัดการล็อกไม่หลุด โดนสอยร่วง" },
                  { label: "ยิงพลุล่อเป้า (Flares) แล้วหักเลี้ยวฉีกออก", correct: true },
                  { label: "หันหน้ากลับไปแลกหมัด", correct: false, deathMsg: "ข้าศึกยิงออกมาก่อน คุณระเบิดกลางอากาศ" },
                  { label: "เร่งความเร็วหนีสุดชีวิต", correct: false, deathMsg: "จรวดข้าศึกเร็วกว่าเครื่องคุณ เรียบร้อย..." }
                ]
              },
              {
                text: "กระสุนใกล้หมด เหลือข้าศึก 1 ลำบินสวนทางมา (Head-on)",
                enemyAction: "ข้าศึกกราดกระสุนปืนกลมาเป็นกำแพง",
                options: [
                  { label: "ยิงสวนวัดใจกันไปเลย", correct: false, deathMsg: "แลกกันตายทั้งคู่ แต่คุณคือผู้แพ้ในสงครามนี้" },
                  { label: "ม้วนตัว Barrel Roll หลบกระสุนแล้วสวนกลับ", correct: true },
                  { label: "ก้มหัวหลบ", correct: false, deathMsg: "กระสุนเจาะทะลุกระจกห้องนักบิน" },
                  { label: "หักหลบออกซ้ายทันที", correct: false, deathMsg: "ปีกขวาโดนยิงขาด เครื่องหมุนควงสว่านลงพื้น" }
                ]
              },
              {
                text: "กำลังกลับฐาน พบระบบลงจอดขัดข้อง ล้อไม่กาง",
                enemyAction: "น้ำมันกำลังจะหมด ไม่มีศัตรูแต่เป็นภัยจากเครื่องจักร",
                options: [
                  { label: "ดีดตัวหนีทิ้งเครื่องราคาแพง", correct: false, deathMsg: "ผู้บัญชาการสั่งประหารชีวิตฐานทิ้งทรัพย์สินราชการโดยไม่จำเป็น" },
                  { label: "บินวนรอจนน้ำมันหมด", correct: false, deathMsg: "เครื่องยนต์ดับ ตกกระแทกพื้นระเบิด" },
                  { label: "ลงจอดด้วยท้องเครื่อง (Belly Landing) บนรันเวย์โฟม", correct: true },
                  { label: "พยายามกระแทกล้อให้กางออก", correct: false, deathMsg: "โครงสร้างเสียหาย เครื่องระเบิดกลางอากาศ" }
                ]
              }
            ]
          },
          {
            level: 2,
            title: "สมรภูมิน่านน้ำ (Ocean Skirmish)",
            missions: [
              {
                text: "บินต่ำเหนือผิวน้ำเพื่อหลบเรดาร์ ข้าศึกดักหน้า!",
                enemyAction: "ข้าศึกยิงปืนใหญ่ต่อสู้อากาศยานจากเรือรบ",
                options: [
                  { label: "เชิดหัวขึ้นฟ้าหนี", correct: false, deathMsg: "ขึ้นไปเจอเรดาร์ล็อกเป้า โดน SAM สอยร่วง" },
                  { label: "บินเลียดน้ำระดับ 10 เมตรต่อไปด้วยความเร็วสูง", correct: true },
                  { label: "เลี้ยวกลับฐาน", correct: false, deathMsg: "โดนไล่หลังยิงตกทะเล" },
                  { label: "ยิงใส่เรือรบด้วยปืนกล", correct: false, deathMsg: "เกราะเรือหนาเกินไป คุณบินชนเสากระโดงเรือ" }
                ]
              },
              {
                text: "เจอกองบินข้าศึก 3 ลำ บินเกาะกลุ่มกันแน่น",
                enemyAction: "ข้าศึกตั้งขบวนทัพสามเหลี่ยม เตรียมโจมตี",
                options: [
                  { label: "ยิงใส่ลำกลางเพื่อให้แตกตื่น", correct: false, deathMsg: "อีก 2 ลำแยกตัวแล้วรุมยิงคุณจากด้านข้าง" },
                  { label: "ยิงจรวดใส่ลำซ้ายสุดเพื่อให้เสียขบวน", correct: true },
                  { label: "บินฝ่ากลางวง", correct: false, deathMsg: "ชนกันกลางอากาศ เละเป็นโจ๊ก" },
                  { label: "บินหนีลงน้ำ", correct: false, deathMsg: "ตกทะเลตายเอง" }
                ]
              },
              {
                text: "สภาพอากาศแปรปรวน พายุฝนกระหน่ำ มองไม่เห็นทาง",
                enemyAction: "เรดาร์ตรวจจับศัตรูไม่ได้ แต่มีเสียงเครื่องยนต์ใกล้เข้ามา",
                options: [
                  { label: "เปิดไฟหน้าเครื่องบิน", correct: false, deathMsg: "กลายเป็นเป้าล่อกระสุนชัดเจน โดนยิงพรุน" },
                  { label: "ดูมาตรวัดความสูงและเรดาร์แทนสายตา", correct: true },
                  { label: "บินต่ำลงหาผิวน้ำ", correct: false, deathMsg: "คลื่นลูกใหญ่ซัดเครื่องบินตกทะเล" },
                  { label: "วิทยุถามศัตรูว่าอยู่ไหน", correct: false, deathMsg: "ศัตรูจับสัญญาณได้และยิงจรวดใส่คุณ" }
                ]
              },
              {
                text: "จรวดนำวิถีข้าศึกเกาะท้ายคุณมา 2 ลูก!",
                enemyAction: "จรวดกำลังพุ่งเข้ามาด้วยความเร็วสูง",
                options: [
                  { label: "บินขึ้นไปหาดวงอาทิตย์", correct: true },
                  { label: "บินลงน้ำ", correct: false, deathMsg: "หนีไม่พ้น จรวดระเบิดใส่ท้ายเครื่อง" },
                  { label: "หยุดเครื่องทันที", correct: false, deathMsg: "เครื่องยนต์ดับ จรวดชนตูม" },
                  { label: "เลี้ยวซ้ายขวาสลับกัน", correct: false, deathMsg: "จรวดรุ่นใหม่ฉลาดกว่านั้น มันดักทางคุณได้" }
                ]
              },
              {
                text: "เรือบรรทุกเครื่องบินข้าศึกอยู่ตรงหน้า ต้องทิ้งระเบิด",
                enemyAction: "ป้อมปืน CIWS ของเรือยิงสกัดกั้นหนาแน่น",
                options: [
                  { label: "บินโฉบลงไปทิ้งระเบิดแนวราบ", correct: false, deathMsg: "โดนปืนต่อต้านอากาศยานยิงพรุนก่อนถึงเป้า" },
                  { label: "บินดิ่งพสุธา (Dive Bomb) จากมุมสูง", correct: true },
                  { label: "ยิงจรวดจากระยะไกลมาก", correct: false, deathMsg: "ระบบป้องกันภัยเรือยิงจรวดคุณทิ้งหมด" },
                  { label: "พุ่งชนเรือแบบกามิกาเซ่", correct: false, deathMsg: "คุณตาย... ภารกิจอาจสำเร็จแต่เกมจบ" }
                ]
              }
            ]
          },
          {
            level: 3,
            title: "หุบเขาปีศาจ (Canyon Run)",
            missions: [
              {
                text: "ต้องบินผ่านหุบเขาแคบๆ เพื่อหลบเรดาร์",
                enemyAction: "โขดหินสลับซับซ้อน ข้าศึกดักอยู่ปากทาง",
                options: [
                  { label: "บินเหนือหุบเขา", correct: false, deathMsg: "เรดาร์จับได้ โดนสอยร่วงทันที" },
                  { label: "บินตะแคงข้าง (Knife Edge) ผ่านช่องแคบ", correct: true },
                  { label: "บินช้าๆ ค่อยๆ ไป", correct: false, deathMsg: "ช้าเกินไป เครื่องยนต์ Stall ตกกระแทกหิน" },
                  { label: "ยิงจรวดนำทางไปข้างหน้า", correct: false, deathMsg: "จรวดชนผนังถ้ำ ระเบิดใส่หน้าตัวเอง" }
                ]
              },
              {
                text: "เฮลิคอปเตอร์ติดอาวุธข้าศึกโผล่ขึ้นมาจากหุบเขา",
                enemyAction: "ฮ. ยิงจรวดและปืนกลหนักใส่",
                options: [
                  { label: "บินวนรอบ ฮ. เพื่อยิง", correct: false, deathMsg: "ฮ. หมุนตัวเร็วกว่าคุณ โดนยิงพรุน" },
                  { label: "บินโฉบยิงแล้วหนี (Hit and Run)", correct: true },
                  { label: "หยุดกลางอากาศรอเล็ง", correct: false, deathMsg: "เครื่องบินหยุดไม่ได้! คุณร่วงตกพื้น" },
                  { label: "ชน ฮ. ให้ร่วง", correct: false, deathMsg: "ปีกหัก เครื่องระเบิดคู่" }
                ]
              },
              {
                text: "สะพานข้ามแม่น้ำมีรถถังข้าศึกข้ามอยู่",
                enemyAction: "รถถังเล็งปืนใหญ่ขึ้นฟ้า",
                options: [
                  { label: "บินลอดใต้สะพาน", correct: false, deathMsg: "ชนตอม่อสะพาน ตายคาที่" },
                  { label: "ยิงทำลายตอม่อสะพาน", correct: true },
                  { label: "ยิงรถถังทีละคัน", correct: false, deathMsg: "กระสุนไม่เข้าเกราะรถถัง โดนสวนกลับร่วง" },
                  { label: "บินผ่านไปเฉยๆ", correct: false, deathMsg: "รถถังสอยคุณร่วงจากข้างหลัง" }
                ]
              },
              {
                text: "ทางออกหุบเขาถูกปิดด้วยตาข่ายเลเซอร์",
                enemyAction: "กับดักทำงานเต็มระบบ",
                options: [
                  { label: "บินชนตาข่าย", correct: false, deathMsg: "เลเซอร์ตัดเครื่องบินคุณเป็นชิ้นๆ" },
                  { label: "ยิงทำลายเครื่องกำเนิดพลังงานที่พื้น", correct: true },
                  { label: "บินย้อนกลับทางเดิม", correct: false, deathMsg: "เชื้อเพลิงไม่พอ บินชนผนังตาย" },
                  { label: "ดีดตัวหนี", correct: false, deathMsg: "ร่มชูชีพกางไปโดนเลเซอร์ ตัวขาดครึ่ง" }
                ]
              },
              {
                text: "บอสประจำด่าน: ป้อมปืนใหญ่ยักษ์บนยอดเขา",
                enemyAction: "ป้อมปืนหมุนช้าๆ แต่ยิงกระสุนลูกใหญ่มาก",
                options: [
                  { label: "บินเข้าหาป้อมปืนตรงๆ", correct: false, deathMsg: "โดนยิงสวนตูมเดียวหายไปทั้งลำ" },
                  { label: "บินต่ำเกาะภูมิประเทศแล้วโผล่ยิงจุดบอด", correct: true },
                  { label: "บินวนรอบๆ รอจนมันกระสุนหมด", correct: false, deathMsg: "ป้อมนี้กระสุนไม่จำกัด คุณโดนสอยในที่สุด" },
                  { label: "ยิงจรวดจากระยะไกลสุดขอบฟ้า", correct: false, deathMsg: "ระบบป้องกันระยะไกลทำลายจรวดคุณหมด" }
                ]
              }
            ]
          },
          {
            level: 4,
            title: "ปฏิบัติการไร้เงา (Stealth Ops)",
            missions: [
              {
                text: "ภารกิจลอบเร้นในเวลากลางคืน ห้ามให้ข้าศึกรู้ตัว",
                enemyAction: "เรดาร์กวาดหาสัญญาณตลอดเวลา",
                options: [
                  { label: "ใช้ความเร็วเสียง (Mach 2)", correct: false, deathMsg: "Sonic Boom ดังสนั่น ข้าศึกรู้ตัว ยิงร่วง" },
                  { label: "ปิดวิทยุและระบบสื่อสารทั้งหมด (Radio Silence)", correct: true },
                  { label: "บินสูงเสียดฟ้า", correct: false, deathMsg: "โดนเรดาร์ระยะไกลจับได้ จรวดพุ่งใส่" },
                  { label: "บินเลียดพื้นพร้อมเปิดไฟ", correct: false, deathMsg: "ทหารยามมองเห็น ยิงปืนต้านอากาศยานใส่" }
                ]
              },
              {
                text: "พบเป้าหมายโรงงานผลิตอาวุธ แต่มีการพรางตัว",
                enemyAction: "เป้าหมายดูเหมือนเนินเขาธรรมดา",
                options: [
                  { label: "สุ่มยิงไปมั่วๆ", correct: false, deathMsg: "พลาดเป้า กระสุนหมด ข้าศึกรู้ตัว" },
                  { label: "ใช้กล้องอินฟราเรดตรวจจับความร้อน", correct: true },
                  { label: "บินลงไปดูใกล้ๆ", correct: false, deathMsg: "ปืนต่อสู้อากาศยานระยะประชิดยิงคุณพรุน" },
                  { label: "รอจนเช้า", correct: false, deathMsg: "น้ำมันหมด ตกกลางป่า" }
                ]
              },
              {
                text: "โดนเครื่องบินสเตลธ์ข้าศึก (Ghost) ล็อกเป้า แต่เรดาร์มองไม่เห็นมัน",
                enemyAction: "สัญญาณเตือนภัยดังแต่ไม่เห็นตัวศัตรู",
                options: [
                  { label: "ยิงกราดไปรอบตัว", correct: false, deathMsg: "กระสุนหมดเปล่าประโยชน์ โดนสอยร่วง" },
                  { label: "สังเกตความผิดปกติของอากาศ (Displacement)", correct: true },
                  { label: "บินหนีสุดแรง", correct: false, deathMsg: "หนีสิ่งที่มองไม่เห็นไม่ได้ จรวดเข้าเป้า" },
                  { label: "กางล้อลงจอดเพื่อลดความเร็ว", correct: false, deathMsg: "กลายเป็นเป้านิ่งให้ผีเคี้ยวเล่น" }
                ]
              },
              {
                text: "ระบบนำร่องถูกรบกวน (Jamming)",
                enemyAction: "หน้าจอ HUD ซ่า ดับๆ ติดๆ",
                options: [
                  { label: "ทุบหน้าจอ", correct: false, deathMsg: "หน้าจอแตก มองอะไรไม่เห็น ชนภูเขา" },
                  { label: "บินด้วยสายตาและเข็มทิศแม่เหล็กสำรอง", correct: true },
                  { label: "รีสตาร์ทระบบเครื่องกลางอากาศ", correct: false, deathMsg: "เครื่องยนต์ดับ สตาร์ทไม่ติด ตกตาย" },
                  { label: "กดยิงมั่ว", correct: false, deathMsg: "จรวดล็อกเป้าพวกเดียวกันเอง ยิงเพื่อนตก โดนศาลทหารสั่งประหาร" }
                ]
              },
              {
                text: "หนีออกจากพื้นที่ ข้าศึกปิดล้อมทุกทิศทาง",
                enemyAction: "ตาข่ายเรดาร์ครอบคลุมพื้นที่ทั้งหมด",
                options: [
                  { label: "บินฝ่าวงล้อมตรงกลาง", correct: false, deathMsg: "โดนรุมยิงเละเป็นผุยผง" },
                  { label: "บินเกาะท้ายเครื่องบินพาณิชย์ที่ผ่านมา", correct: true },
                  { label: "แกล้งทำเป็นเครื่องตก", correct: false, deathMsg: "ตกจริงๆ เพราะกู้เครื่องไม่ทัน" },
                  { label: "ยอมจำนน", correct: false, deathMsg: "โดนจับไปทรมานและประหารชีวิต เกมโอเวอร์" }
                ]
              }
            ]
          },
          {
            level: 5,
            title: "ยุทธการเวหา (Dogfight Mastery)",
            missions: [
              {
                text: "ดวลเดี่ยวกับ Ace Pilot ฝ่ายตรงข้าม",
                enemyAction: "มันทำท่า Cobra Maneuver เบรกกลางอากาศให้คุณบินเลยไป",
                options: [
                  { label: "บินเลยไปแล้วเลี้ยวกลับ", correct: false, deathMsg: "มันอยู่ท้ายคุณแล้ว ยิงจรวดใส่ตูดคุณเต็มๆ" },
                  { label: "ดึงเบรกอากาศและเชิดหัวขึ้นทันที (High Yo-Yo)", correct: true },
                  { label: "ยิงจรวดใส่ตอนมันเบรก", correct: false, deathMsg: "จรวดล็อกเป้าไม่ทัน พลาดเป้า" },
                  { label: "ดีดตัวหนี", correct: false, deathMsg: "ยอมแพ้ให้กับศักดิ์ศรีนักบิน ตายดีกว่า" }
                ]
              },
              {
                text: "ข้าศึกใช้ปืนเลเซอร์ความแม่นยำสูง",
                enemyAction: "ลำแสงสีแดงกวาดไล่ล่าเครื่องคุณ",
                options: [
                  { label: "บินเป็นเส้นตรงเร็วๆ", correct: false, deathMsg: "เลเซอร์เดินทางด้วยความเร็วแสง คุณหนีไม่พ้น ปีกขาด" },
                  { label: "ใช้ผิวมันวาวของเครื่องสะท้อนแสง", correct: false, deathMsg: "มันเป็นเลเซอร์ความร้อนสูง เครื่องละลายทั้งลำ" },
                  { label: "บินควงสว่าน (Barrel Roll) ต่อเนื่อง", correct: true },
                  { label: "ยิงสวน", correct: false, deathMsg: "ปืนคุณพังเพราะโดนเลเซอร์เผา ระเบิดคาลำ" }
                ]
              },
              {
                text: "เครื่องยนต์เสียหายหนึ่งข้าง ไฟไหม้",
                enemyAction: "ข้าศึกเห็นคุณบาดเจ็บจึงรุมเข้ามาซ้ำ",
                options: [
                  { label: "ดับเครื่องยนต์ที่ไฟไหม้และปรับสมดุลปีก (Trim)", correct: true },
                  { label: "เร่งเครื่องทั้งสองข้างหนี", correct: false, deathMsg: "ไฟลามไปถังน้ำมัน ระเบิดตูมตาม" },
                  { label: "หันหัวพุ่งชนข้าศึก", correct: false, deathMsg: "ควบคุมเครื่องไม่อยู่ หมุนคว้างตกทะเล" },
                  { label: "ปล่อยน้ำมันทิ้งใส่หน้าข้าศึก", correct: false, deathMsg: "ไฟไหม้ลามตามสายน้ำมันมาเผาตัวเอง" }
                ]
              },
              {
                text: "กระสุนหมด จรวดหมด เหลือแต่ถังน้ำมันสำรอง",
                enemyAction: "ข้าศึกบินไล่หลังมาติดๆ",
                options: [
                  { label: "ปลดถังน้ำมันสำรองใส่หน้าข้าศึก", correct: true },
                  { label: "ตะโกนด่าผ่านวิทยุ", correct: false, deathMsg: "ข้าศึกรำคาญเลยยิงทิ้งทันที" },
                  { label: "พยายามเอาปีกฟาด", correct: false, deathMsg: "ปีกหักเอง ร่วง" },
                  { label: "บินหนีไปเรื่อยๆ", correct: false, deathMsg: "โดนยิงตูดพรุน" }
                ]
              },
              {
                text: "เผชิญหน้าฝูงโดรนรบอัตโนมัติ 50 ลำ (Swarm)",
                enemyAction: "โดรนบินวนรอบตัวเหมือนฝูงผึ้ง",
                options: [
                  { label: "ยิงทีละตัว", correct: false, deathMsg: "ยิงไม่ทัน โดนรุมทึ้งจนเละ" },
                  { label: "ปล่อยระเบิด EMP (Electromagnetic Pulse)", correct: true },
                  { label: "บินหนีขึ้นอวกาศ", correct: false, deathMsg: "เครื่องยนต์ขาดออกซิเจน ดับกลางอากาศ ร่วงลงมาตาย" },
                  { label: "บินแทรกตัวในกลุ่มโดรน", correct: false, deathMsg: "ชนโดรนระเบิดตาย" }
                ]
              }
            ]
          },
          {
            level: 6,
            title: "โจมตีฐานทัพลอยฟ้า (Sky Fortress)",
            missions: [
              {
                text: "ฐานทัพลอยฟ้ามีเกราะพลังงานป้องกัน",
                enemyAction: "กระสุนทุกชนิดเด้งออกหมด",
                options: [
                  { label: "ยิงซ้ำๆ จุดเดิม", correct: false, deathMsg: "กระสุนสะท้อนกลับมาโดนตัวเอง" },
                  { label: "หาเครื่องกำเนิดสนามพลังภายนอกแล้วทำลาย", correct: true },
                  { label: "พุ่งชนเกราะ", correct: false, deathMsg: "เหมือนแมลงชนกระจก เละ" },
                  { label: "รอให้พลังงานหมด", correct: false, deathMsg: "มันใช้พลังนิวเคลียร์ รอไปอีก 100 ปี คุณแก่ตายก่อน" }
                ]
              },
              {
                text: "ป้อมปืนเลเซอร์ยิงสกัดหนาแน่น",
                enemyAction: "ไม่มีช่องว่างให้บินเข้า",
                options: [
                  { label: "บินเกาะใต้ท้องยานลูกสมุนเพื่อบังกระสุน", correct: true },
                  { label: "บินฝ่าเข้าไป", correct: false, deathMsg: "ระเหยกลายเป็นไอใน 1 วินาที" },
                  { label: "ยิงจรวดใส่ป้อม", correct: false, deathMsg: "จรวดโดนยิงทิ้งกลางทาง" },
                  { label: "ถอยกลับตั้งหลัก", correct: false, deathMsg: "โดนปืนระยะไกลสอยร่วง" }
                ]
              },
              {
                text: "ต้องบินเข้าไปในท่อระบายความร้อน (เหมือน Star Wars)",
                enemyAction: "ท่อแคบและมีพัดลมยักษ์หมุนอยู่",
                options: [
                  { label: "ยิงพัดลมให้พัง", correct: true },
                  { label: "บินหลบใบพัด", correct: false, deathMsg: "ใบพัดหมุนเร็วเกินไป สับเครื่องคุณเป็นชิ้นๆ" },
                  { label: "หยุดเครื่องหน้าพัดลม", correct: false, deathMsg: "ความร้อนในท่อหลอมละลายเครื่องคุณ" },
                  { label: "ถอยหลังออก", correct: false, deathMsg: "ไม่มีที่กลับตัว ชนผนังตาย" }
                ]
              },
              {
                text: "แกนกลางปฏิกรณ์กำลังจะระเบิด",
                enemyAction: "ความร้อนพุ่งสูง ระบบเตือนภัยดังลั่น",
                options: [
                  { label: "บินหนีออกทางเดิม", correct: false, deathMsg: "ทางเดิมถูกปิดตาย โดนเผา" },
                  { label: "เร่งเครื่องทะลุออกอีกฝั่ง (Afterburner)", correct: true },
                  { label: "กางร่มชูชีพ", correct: false, deathMsg: "ร่มไหม้ไฟ ตกไปในลาวาปฏิกรณ์" },
                  { label: "รอถ่ายรูปเป็นที่ระลึก", correct: false, deathMsg: "ได้รูปสวยก่อนตาย แต่ไม่ได้โพสต์" }
                ]
              },
              {
                text: "ฐานทัพกำลังร่วงลงสู่พื้นโลก",
                enemyAction: "แรงระเบิดดูดทุกอย่างเข้าไป",
                options: [
                  { label: "บินตามแรงดูดไป", correct: false, deathMsg: "โดนซากฐานทัพทับตาย" },
                  { label: "บินฉีกออกด้านข้างตั้งฉากกับแรงระเบิด", correct: true },
                  { label: "บินสวนแรงระเบิด", correct: false, deathMsg: "สู้แรงลมไม่ไหว ปีกฉีกขาด" },
                  { label: "สวดมนต์", correct: false, deathMsg: "พระเจ้าช่วยไม่ได้ในเกมนี้" }
                ]
              }
            ]
          },
          {
            level: 7,
            title: "เขตแดนนรก (Inferno Zone)",
            missions: [
              {
                text: "บินผ่านภูเขาไฟระเบิด ควันและเถ้าถ่านหนาทึบ",
                enemyAction: "ทัศนวิสัยเป็นศูนย์ เครื่องยนต์เริ่มสำลักฝุ่น",
                options: [
                  { label: "เร่งเครื่องเต็มสูบ", correct: false, deathMsg: "เครื่องยนต์ดูดเถ้าภูเขาไฟเข้าไป พังและระเบิด" },
                  { label: "ลดรอบเครื่องบินร่อน (Glide) และบินสูงเหนือควัน", correct: true },
                  { label: "บินต่ำลงหาลาวา", correct: false, deathMsg: "ความร้อนหลอมละลายปีก ร่วงลงบ่อลาวา" },
                  { label: "เปิดแอร์ในห้องนักบิน", correct: false, deathMsg: "ระบบกรองอากาศตัน ขาดอากาศหายใจตาย" }
                ]
              },
              {
                text: "ลาวากระเด็นขึ้นมาเป็นลูกไฟยักษ์",
                enemyAction: "หินร้อนพุ่งใส่เหมือนฝนดาวตก",
                options: [
                  { label: "ยิงจรวดใส่หิน", correct: false, deathMsg: "หินแตกเป็นเสี่ยงๆ เล็กๆ พุ่งใส่กระจกแตก พรุน" },
                  { label: "หักหลบซ้ายขวา", correct: true },
                  { label: "กางโล่พลังงาน", correct: false, deathMsg: "เครื่องคุณไม่มีระบบนั้น! เพ้อเจ้อจนตาย" },
                  { label: "บินหลับตา", correct: false, deathMsg: "ชนภูเขาตาย" }
                ]
              },
              {
                text: "เครื่องบินข้าศึกซ่อนตัวในควันดำ",
                enemyAction: "มันโผล่มายิงแล้วหนีเข้าควัน",
                options: [
                  { label: "บินตามเข้าควันไป", correct: false, deathMsg: "ชนหน้าผาในควัน ตาย" },
                  { label: "ยิงกราดเข้าไปในควัน", correct: false, deathMsg: "กระสุนหมด ข้าศึกบินออกมาสอยคุณทิ้ง" },
                  { label: "ดึงตัวขึ้นสูงล่อให้มันตามออกมาที่โล่ง", correct: true },
                  { label: "จอดพัก", correct: false, deathMsg: "ไม่มีที่จอด! ตกภูเขาตาย" }
                ]
              },
              {
                text: "ความร้อนทำให้จรวดมิสไซล์ทำงานผิดพลาด",
                enemyAction: "จรวดคุณเริ่มล็อกเป้ามั่วซั่ว",
                options: [
                  { label: "ปิดระบบอาวุธทั้งหมดชั่วคราว", correct: true },
                  { label: "ฝืนยิงต่อไป", correct: false, deathMsg: "จรวดระเบิดคารางปล่อย ปีกขาด" },
                  { label: "ทุบแผงควบคุม", correct: false, deathMsg: "ไฟช็อต ควันคลุ้งห้องนักบิน สำลักตาย" },
                  { label: "บินกลับฐาน", correct: false, deathMsg: "ไม่ทันการณ์ โดนข้าศึกสอยร่วง" }
                ]
              },
              {
                text: "บอส: เครื่องบินหุ้มเกราะทนความร้อน",
                enemyAction: "มันพยายามเบียดคุณให้ตกไปในปากปล่องภูเขาไฟ",
                options: [
                  { label: "เบียดสู้มัน", correct: false, deathMsg: "เครื่องมันหนักกว่า คุณกระเด็นตกลาวา" },
                  { label: "บินล่อให้มันบินผ่านลาวาพุ", correct: true },
                  { label: "ยิงปืนกลใส่มัน", correct: false, deathMsg: "เกราะมันหนา กระสุนเด้งออกหมด โดนชนตก" },
                  { label: "ดีดตัวหนี", correct: false, deathMsg: "ร่มชูชีพไหม้ ตกลาวา" }
                ]
              }
            ]
          },
          {
            level: 8,
            title: "สงครามข้ามมิติ (Dimensional War)",
            missions: [
              {
                text: "ข้าศึกใช้อาวุธวาร์ป หายตัวไปมาได้",
                enemyAction: "มันวาร์ปมาโผล่ข้างหลังคุณ",
                options: [
                  { label: "หันหลังกลับไปยิง", correct: false, deathMsg: "ช้าไป โดนยิงร่วง" },
                  { label: "ทิ้งทุ่นระเบิดอากาศ (Air Mines) ดักหลัง", correct: true },
                  { label: "วาร์ปหนีบ้าง", correct: false, deathMsg: "คุณไม่มีเทคโนโลยีนั้น! กดปุ่มมั่วจนเครื่องดับ" },
                  { label: "บินเป็นวงกลม", correct: false, deathMsg: "มันดักทางได้ ยิงดักหน้า" }
                ]
              },
              {
                text: "มิติเริ่มบิดเบี้ยว เพดานบินกลับหัว",
                enemyAction: "ท้องฟ้ากลายเป็นพื้นดิน",
                options: [
                  { label: "ฝืนบินท่าปกติ", correct: false, deathMsg: "แรงโน้มถ่วงกลับด้าน เลือดตกลงหัว หมดสติ เครื่องตก" },
                  { label: "บินกลับหัว (Inverted Flight) ตามสภาพมิติ", correct: true },
                  { label: "หลับตาแล้วบิน", correct: false, deathMsg: "ชนตึกที่ห้อยลงมาจากฟ้า" },
                  { label: "อาเจียน", correct: false, deathMsg: "สำลักอ้วกตัวเองตาย" }
                ]
              },
              {
                text: "ศัตรูยิงกระสุนหยุดเวลา (Time Stasis)",
                enemyAction: "กระสุนสีม่วงลอยช้าๆ แต่ถ้าโดนคือจบ",
                options: [
                  { label: "บินไปแตะดู", correct: false, deathMsg: "ตัวคุณแข็งค้างตลอดกาล กลายเป็นอนุสาวรีย์ลอยฟ้า" },
                  { label: "หลบให้พ้นระยะ", correct: true },
                  { label: "ยิงกระสุนใส่", correct: false, deathMsg: "กระสุนคุณก็หยุดเวลาเหมือนกัน สะสมพลังงานจนระเบิด" },
                  { label: "บินช้าๆ ให้เท่ากัน", correct: false, deathMsg: "โดนดูดเข้าไปใน Time Vortex หายสาบสูญ" }
                ]
              },
              {
                text: "เจอร่างแยกของตัวเองจากอีกมิติ (Doppelganger)",
                enemyAction: "มันบินเหมือนคุณ ยิงเหมือนคุณทุกอย่าง",
                options: [
                  { label: "ทำท่าที่คาดเดาได้ยาก (Crazy Ivan)", correct: true },
                  { label: "บินท่ามาตรฐาน", correct: false, deathMsg: "มันรู้อยู่แล้ว ดักทางถูก ยิงคุณร่วง" },
                  { label: "ชวนคุย", correct: false, deathMsg: "มันไม่คุย มันยิงแสกหน้า" },
                  { label: "บินหนี", correct: false, deathMsg: "มันเร็วกว่าคุณ เพราะมันคือเวอร์ชั่นที่ดีกว่า" }
                ]
              },
              {
                text: "ประตูมิติกำลังปิด",
                enemyAction: "แรงดึงดูดมหาศาล",
                options: [
                  { label: "ยิงนิวเคลียร์ใส่ประตู", correct: false, deathMsg: "แรงระเบิดย้อนกลับมาฆ่าคุณ" },
                  { label: "ปลดสัมภาระทุกอย่างแล้วพุ่งออก", correct: true },
                  { label: "บินช้าๆ", correct: false, deathMsg: "ประตูงับเครื่องบินขาดครึ่ง" },
                  { label: "รอประตูเปิดอีกรอบ", correct: false, deathMsg: "อีก 1,000 ปี กว่าจะเปิด คุณแห้งตายก่อน" }
                ]
              }
            ]
          },
          {
            level: 9,
            title: "บุกเดี่ยว (The Suicide Run)",
            missions: [
              {
                text: "เพื่อนร่วมทีมตายหมด เหลือคุณคนเดียวกลางดงข้าศึก 100 ลำ",
                enemyAction: "ข้าศึกประมาท บินเข้ามาล้อมกรอบ",
                options: [
                  { label: "ยอมแพ้", correct: false, deathMsg: "โดนจับไปประหาร ขี้ขลาดตาขาว" },
                  { label: "เล็งยิงถังน้ำมันเรือเหาะยักษ์ใกล้ๆ", correct: true },
                  { label: "กราดยิงไปเรื่อย", correct: false, deathMsg: "กระสุนหมดใน 5 วิ โดนรุมตาย" },
                  { label: "ตะโกนร้องไห้", correct: false, deathMsg: "น้ำตาบังมองไม่เห็นทาง ชนกันเองตาย" }
                ]
              },
              {
                text: "ซากเรือเหาะระเบิด เกิดลูกไฟยักษ์กลางอากาศ",
                enemyAction: "แรงระเบิดผลักทุกอย่างกระเด็น",
                options: [
                  { label: "ขี่คลื่นกระแทก (Shockwave) หนีออกมา", correct: true },
                  { label: "บินต้านแรงลม", correct: false, deathMsg: "ปีกฉีกขาด เครื่องหมุนติ้วตกพื้น" },
                  { label: "หยุดดูผลงาน", correct: false, deathMsg: "โดนสะเก็ดระเบิดเสียบห้องนักบิน" },
                  { label: "บินลงพื้น", correct: false, deathMsg: "โดนแรงอัดกระแทกพื้นแบนแต๊ดแต๋" }
                ]
              },
              {
                text: "กระสุนหมดเกลี้ยง เหลือแต่จรวด 1 ลูก",
                enemyAction: "แม่ทัพข้าศึกขับเครื่องบินเกราะทองคำออกมา",
                options: [
                  { label: "ยิงจรวดใส่เกราะหน้า", correct: false, deathMsg: "ไม่ระคายผิว โดนสวนตาย" },
                  { label: "ล็อกเป้าที่ท่อไอพ่นท้ายเครื่อง", correct: true },
                  { label: "บินพุ่งชน", correct: false, deathMsg: "เครื่องมันแข็งกว่า คุณเละฝ่ายเดียว" },
                  { label: "ขว้างหมวกกันน็อคใส่", correct: false, deathMsg: "ตลกตายล่ะ..." }
                ]
              },
              {
                text: "เครื่องยนต์ข้าศึกระเบิด แต่มันยังร่อนลงจอดได้",
                enemyAction: "มันพยายามหนีไปขึ้นยานสำรอง",
                options: [
                  { label: "บินลงไปยิงซ้ำด้วยปืนพก (เปิดกระจกยิง)", correct: false, deathMsg: "ลมตีหน้าแหก เครื่องตก" },
                  { label: "ใช้ปีกเฉือนร่มชูชีพมัน", correct: true },
                  { label: "ปล่อยมันไป", correct: false, deathMsg: "มันกลับมาพร้อมยานรบเทพ สอยคุณร่วงทันที" },
                  { label: "ลงจอดไปจับกุม", correct: false, deathMsg: "กับดักระเบิดทำงาน ตูม!" }
                ]
              },
              {
                text: "เรดาร์ตรวจพบขีปนาวุธนิวเคลียร์ถูกยิงออกมา",
                enemyAction: "เป้าหมายคือเมืองหลวงของคุณ",
                options: [
                  { label: "บินไปรับลูกนิวเคลียร์ด้วยตัวเปล่า", correct: false, deathMsg: "ตายแน่นอน และเมืองก็ไม่รอด" },
                  { label: "ยิงทำลายระบบนำวิถีที่ส่วนหัวจรวด", correct: true },
                  { label: "บินแข่งกับจรวด", correct: false, deathMsg: "จรวดเร็วกว่า 10 เท่า เมืองบึ้ม คุณก็โดนลูกหลง" },
                  { label: "แจ้งให้เมืองอพยพ", correct: false, deathMsg: "ไม่ทันแล้ว เมืองหายเป็นจุล" }
                ]
              }
            ]
          },
          {
            level: 10,
            title: "จุดจบและจุดเริ่มต้น (Final Battle)",
            missions: [
              {
                text: "บอสใหญ่: ป้อมปราการลอยฟ้าขนาดเท่าเมือง (Mothership)",
                enemyAction: "มันปล่อยเลเซอร์ขนาดใหญ่ผ่าท้องฟ้า",
                options: [
                  { label: "บินหลบไปใต้ท้องยาน", correct: true },
                  { label: "กางร่มชูชีพยอมแพ้", correct: false, deathMsg: "เลเซอร์เผาทั้งคนทั้งร่ม" },
                  { label: "ยิงสวนเลเซอร์", correct: false, deathMsg: "บ้าบอ... คุณสู้แสงไม่ได้" },
                  { label: "บินหนีสุดขอบโลก", correct: false, deathMsg: "โลกไม่มีที่หนี ยานแม่ยิงเลเซอร์ตามไปเผา" }
                ]
              },
              {
                text: "ใต้ท้องยานมีช่องระบายความร้อนแกนกลาง",
                enemyAction: "มีโดรนป้องกันหนาแน่น",
                options: [
                  { label: "กราดยิงทุกอย่างที่ขวางหน้า", correct: false, deathMsg: "กระสุนหมดก่อนถึงเป้า โดนรุมตาย" },
                  { label: "บินซิกแซกเข้าหาเป้าหมายโดยไม่สนใจโดรน", correct: true },
                  { label: "หยุดรอจังหวะ", correct: false, deathMsg: "เป้านิ่ง = ศพ" },
                  { label: "ขอความช่วยเหลือ", correct: false, deathMsg: "ไม่มีใครเหลือแล้ว คุณคือความหวังเดียว" }
                ]
              },
              {
                text: "ถึงช่องระบายความร้อน แต่มีประตูเหล็กปิดอยู่",
                enemyAction: "ประตูกำลังจะปิดสนิท",
                options: [
                  { label: "ยิงจรวดลูกสุดท้ายใส่ประตู", correct: true },
                  { label: "พุ่งชนประตู", correct: false, deathMsg: "ประตูแข็งมาก คุณแบนติดประตู" },
                  { label: "รอประตูเปิดอีกรอบ", correct: false, deathMsg: "มันไม่เปิดแล้ว ยานแม่ชาร์จพลังยิงโลกแตก" },
                  { label: "เคาะประตู", correct: false, deathMsg: "..." }
                ]
              },
              {
                text: "ประตูพังเสียหาย บินเข้าไปในแกนกลางยานแม่",
                enemyAction: "แกนพลังงานสีฟ้าหมุนติ้ว ร้อนแรงมาก",
                options: [
                  { label: "ดีดตัวหนีแล้วปล่อยเครื่องชนแกนกลาง", correct: true },
                  { label: "ยิงปืนกลใส่", correct: false, deathMsg: "พลังงานทำลายไม่พอ โดนรังสีเผาตาย" },
                  { label: "บินวนดูโครงสร้าง", correct: false, deathMsg: "ความร้อนหลอมละลายเครื่องบิน" },
                  { label: "ถ่ายเซลฟี่", correct: false, deathMsg: "ตายแบบมีสไตล์ แต่ภารกิจล้มเหลว โลกแตก" }
                ]
              },
              {
                text: "คุณลอยร่มชูชีพอยู่ เครื่องบินพุ่งชนแกนกลาง ระเบิดตูมตาม",
                enemyAction: "ยานแม่กำลังจะระเบิดและร่วงลงมาทับคุณ",
                options: [
                  { label: "บังคับร่มชูชีพไปทางลมเพื่อหนีซากยาน", correct: true },
                  { label: "ตัดเชือกร่มทิ้งแล้วดิ่งพสุธา", correct: false, deathMsg: "ตกลงพื้นด้วยความเร็ว 200 กม./ชม. เละเป็นแยม" },
                  { label: "ชื่นชมผลงาน", correct: false, deathMsg: "ซากยานทับแบนแต๊ดแต๋" },
                  { label: "สวดมนต์ (อีกที)", correct: false, deathMsg: "พระเจ้าบอกว่า 'ขยับตัวหน่อยสิลูก'" }
                ]
              }
            ]
          }
        ];

        // --- STATE MANAGEMENT ---
        const state = {
            view: 'menu', // menu, playing, gameover, victory
            level: 1,
            missionIndex: 0,
            score: 0,
            currentScenario: null,
            shuffledOptions: [],
            deathReason: ""
        };

        const app = document.getElementById('app');
        const toast = document.getElementById('toast');

        // --- UTILS ---
        function shuffleArray(array) {
            return array.map(value => ({ value, sort: Math.random() }))
                .sort((a, b) => a.sort - b.sort)
                .map(({ value }) => value);
        }

        // --- AUDIO MANAGEMENT WITH WEB AUDIO API ---
        let audioContext = null;
        const audioBuffers = {};
        const audioSources = {}; // To keep track of playing sources for stopping

        async function preloadAudio() {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const files = ['back.mp3', 'home.mp3', 'lost.mp3', 'pass.mp3', 'win.mp3'];
            for (const file of files) {
                try {
                    const response = await fetch(`audio/${file}`);
                    const arrayBuffer = await response.arrayBuffer();
                    audioBuffers[file] = await audioContext.decodeAudioData(arrayBuffer);
                } catch (err) {
                    console.error(`Failed to load ${file}:`, err);
                }
            }
        }

        function playAudio(file, loop = false) {
            if (!audioBuffers[file] || !audioContext) return;

            const source = audioContext.createBufferSource();
            source.buffer = audioBuffers[file];
            source.connect(audioContext.destination);
            source.loop = loop;
            source.start(0);

            if (loop) {
                audioSources[file] = source; // Store for later stopping
            }
        }

        function stopAudio(file) {
            if (audioSources[file]) {
                audioSources[file].stop(0);
                delete audioSources[file];
            }
        }

        // --- CLIPBOARD FUNCTION (Kept but button is hidden) ---
        function copyGameCode() {
            const code = document.documentElement.outerHTML;
            const textarea = document.createElement('textarea');
            textarea.value = "<!DOCTYPE html>\n" + code;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                showToast();
            } catch (err) {
                console.error('Failed to copy', err);
                alert('ไม่สามารถคัดลอกได้อัตโนมัติ กรุณากด Ctrl+U เพื่อดูซอร์สโค้ดและคัดลอกด้วยตนเอง');
            }
            document.body.removeChild(textarea);
        }

        function showToast() {
            toast.className = "show";
            setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 3000);
        }

        // --- RENDER FUNCTIONS ---
        
        function renderMenu() {
            app.innerHTML = `
                <div class="flex-1 flex flex-col items-center justify-center p-4">
                    <div class="max-w-2xl w-full text-center space-y-8 fade-in">
                        <div class="flex justify-center mb-4">
                            <!-- Plane Icon SVG -->
                            <svg class="w-24 h-24 text-green-500 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                            </svg>
                        </div>
                        <h1 class="text-4xl md:text-6xl font-bold tracking-widest text-green-500 uppercase hud-text-shadow font-mono">
                            ศึกจ้าวเวหา
                            <span class="block text-xl md:text-2xl mt-2 text-green-300">SKY MASTER</span>
                        </h1>
                        
                        <div class="bg-slate-800 p-6 rounded-lg border border-green-700 hud-border-glow">
                            <h2 class="text-2xl font-bold mb-4 flex items-center justify-center gap-2 text-green-400">
                                ภารกิจของคุณ
                            </h2>
                            <p class="text-lg leading-relaxed mb-4 text-green-200">
                                คุณคือนักบินยอดฝีมือแห่งกองทัพอากาศ หน้าที่ของคุณคือพิชิต 10 สมรภูมิเดือด
                                เพื่อปกป้องน่านฟ้าและกอบกู้โลกจากภัยคุกคาม
                            </p>
                            
                            <div class="text-left bg-black p-4 rounded border border-green-800 space-y-2 font-mono text-sm md:text-base">
                                <h3 class="font-bold text-xl text-red-500 mb-2 border-b border-red-900 pb-1">กฎเหล็ก (RULES):</h3>
                                <p class="flex gap-2 text-green-400">➤ มีทั้งหมด 10 ด่าน (Levels) ด่านละ 5 ภารกิจ</p>
                                <p class="flex gap-2 text-green-400">➤ ต้องเลือกการกระทำที่ถูกต้องเพียง 1 ข้อ จาก 4 ตัวเลือก</p>
                                <p class="flex gap-2 text-red-400">☠ <b>PERMADEATH:</b> พลาดครั้งเดียว = ตาย (เริ่มใหม่)</p>
                                <p class="flex gap-2 text-green-400">➤ ความไวและการตัดสินใจคือทุกสิ่ง</p>
                            </div>
                        </div>

                        <div class="flex flex-col md:flex-row gap-4 justify-center">
                            <button onclick="startGame()" class="group relative px-8 py-4 bg-green-900 hover:bg-green-700 text-green-100 font-bold text-xl rounded transition-all duration-300 border border-green-500 hover:shadow-[0_0_20px_rgba(34,197,94,0.6)] flex items-center justify-center gap-2 font-mono">
                                <span>เริ่มภารกิจ (START MISSION)</span>
                            </button>

                            <!-- Hidden copy button -->
                            <!-- <button onclick="copyGameCode()" class="group relative px-6 py-4 bg-slate-800 hover:bg-slate-700 text-cyan-300 font-bold text-lg rounded transition-all duration-300 border border-cyan-500 hover:shadow-[0_0_15px_rgba(34,211,238,0.4)] flex items-center justify-center gap-2 font-mono">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                                <span>คัดลอกโค้ดเกม (COPY CODE)</span>
                            </button> -->
                        </div>
                    </div>
                </div>
            `;
        }

        function renderGame() {
            const scenario = state.currentScenario;
            
            app.innerHTML = `
                <!-- Top HUD -->
                <div class="bg-black/90 border-b border-green-800 p-2 md:p-4 flex justify-between items-center text-green-500 z-20 sticky top-0 backdrop-blur-sm font-mono">
                    <div class="flex items-center gap-4">
                        <div class="text-xs md:text-sm">
                            <p class="text-green-700">LEVEL</p>
                            <p class="text-xl md:text-2xl font-bold">0${state.level}</p>
                        </div>
                        <div class="h-8 w-px bg-green-800"></div>
                        <div class="text-xs md:text-sm">
                            <p class="text-green-700">MISSION</p>
                            <p class="text-xl md:text-2xl font-bold">${state.missionIndex + 1}/5</p>
                        </div>
                    </div>
                    <div class="text-center hidden md:block">
                        <h2 class="text-sm text-green-300 uppercase tracking-widest crt-flicker">${GAME_DATA[state.level - 1].title}</h2>
                    </div>
                    <div class="text-right">
                        <p class="text-green-700 text-xs">SCORE</p>
                        <p class="text-xl font-bold text-yellow-500">${state.score}</p>
                    </div>
                </div>

                <!-- Main Cockpit Area -->
                <div class="flex-1 p-4 md:p-8 flex flex-col items-center justify-center max-w-4xl mx-auto w-full z-10 fade-in">
                    
                    <!-- Radar/Situation Display -->
                    <div class="w-full mb-6 relative group">
                        <div class="absolute -inset-1 bg-gradient-to-r from-green-600 to-emerald-600 rounded-lg blur opacity-25"></div>
                        <div class="relative bg-black border-2 border-green-600 p-6 rounded-lg shadow-2xl">
                            <div class="flex items-start gap-4">
                                <div class="hidden md:block bg-green-900/20 p-3 rounded-full border border-green-500/50 animate-pulse">
                                    <!-- Alert Icon -->
                                    <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                                </div>
                                <div class="space-y-3 w-full">
                                    <h3 id="situation-heading" tabindex="0" class="text-green-400 font-bold text-lg md:text-xl border-b border-green-800 pb-2 w-full font-mono">
                                        SITUATION REPORT
                                    </h3>
                                    <p class="text-white text-lg md:text-xl leading-relaxed font-sans">
                                        ${scenario.text}
                                    </p>
                                    <div class="bg-red-950/30 p-3 rounded border-l-4 border-red-600 mt-2">
                                        <span class="text-red-500 font-bold uppercase text-xs block mb-1 font-mono">ENEMY ACTION:</span>
                                        <p class="text-red-300 italic font-sans">
                                            "${scenario.enemyAction}"
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Choices Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full" id="choices-grid">
                        <!-- Choices injected via loop below -->
                    </div>
                </div>

                <!-- Footer Decor -->
                <div class="fixed bottom-2 left-4 text-green-900 text-[10px] hidden md:block font-mono">
                    SYS.NOMINAL<br>FUEL: 85%<br>AMMO: LOW
                </div>
                <div class="fixed bottom-2 right-4 text-green-900 text-[10px] hidden md:block text-right font-mono">
                    ALT: 35,000 FT<br>SPD: MACH 1.2<br>HDG: 270
                </div>
            `;

            // Inject choices logic
            const grid = document.getElementById('choices-grid');
            state.shuffledOptions.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = "relative overflow-hidden group p-4 bg-slate-800 border-l-4 border-slate-600 hover:border-green-400 hover:bg-slate-700 transition-all duration-200 text-left rounded shadow-lg";
                btn.onclick = () => handleChoice(option);
                
                btn.innerHTML = `
                    <div class="absolute inset-0 bg-green-500/5 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                    <span class="text-slate-500 font-bold mr-3 group-hover:text-green-400 font-mono">
                        ${['A', 'B', 'C', 'D'][index]}.
                    </span>
                    <span class="text-slate-200 group-hover:text-white font-medium text-lg font-sans">
                        ${option.label}
                    </span>
                `;
                grid.appendChild(btn);
            });
        }

        function renderGameOver() {
            app.innerHTML = `
                <div class="min-h-screen bg-red-950 text-red-500 font-mono p-4 flex flex-col items-center justify-center border-4 border-red-800 shake">
                    <div class="max-w-2xl w-full text-center space-y-6">
                        <svg class="w-32 h-32 mx-auto text-red-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                        <h1 class="text-6xl font-black uppercase text-red-600 tracking-tighter">MIA / K.I.A.</h1>
                        <h2 id="result-heading" tabindex="0" class="text-3xl font-bold text-white font-sans">ภารกิจล้มเหลว (MISSION FAILED)</h2>
                        
                        <div class="bg-black p-6 rounded border-2 border-red-800">
                            <p class="text-xl text-red-400 mb-2 font-sans">สาเหตุการเสียชีวิต:</p>
                            <p class="text-2xl text-white font-bold font-sans">"${state.deathReason}"</p>
                        </div>

                        <div class="flex justify-between items-center bg-red-900/30 p-4 rounded text-lg font-mono">
                            <span>Level: ${state.level}</span>
                            <span>Mission: ${state.missionIndex + 1}/5</span>
                            <span>Score: ${state.score}</span>
                        </div>

                        <button onclick="resetToMenu()" class="w-full py-4 bg-red-800 hover:bg-red-700 text-white font-bold text-xl rounded border border-red-500 hover:shadow-[0_0_20px_rgba(220,38,38,0.6)] transition-all font-mono">
                            กลับสู่ฐานทัพ (RETURN TO BASE)
                        </button>
                    </div>
                </div>
            `;
        }

        function renderVictory() {
            app.innerHTML = `
                <div class="min-h-screen bg-blue-950 text-cyan-400 font-mono p-4 flex flex-col items-center justify-center border-4 border-cyan-500">
                    <div class="max-w-2xl w-full text-center space-y-8 fade-in">
                        <svg class="w-32 h-32 mx-auto text-cyan-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <h1 class="text-5xl md:text-7xl font-black uppercase text-cyan-300 hud-text-shadow">
                            VICTORY
                        </h1>
                        <h2 id="result-heading" tabindex="0" class="text-2xl text-white font-sans">ภารกิจสำเร็จลุล่วง! คุณคือเจ้าเวหาที่แท้จริง</h2>
                        
                        <div class="bg-slate-900 p-8 rounded-xl border-2 border-cyan-600">
                            <p class="text-lg text-cyan-200 font-sans">โลกปลอดภัยแล้ว... สำหรับวันนี้</p>
                            <p class="text-4xl font-bold mt-4 text-yellow-400 font-mono">SCORE: ${state.score}</p>
                        </div>

                        <button onclick="resetToMenu()" class="px-8 py-3 bg-cyan-800 hover:bg-cyan-700 text-white font-bold rounded border border-cyan-400 font-mono">
                            กลับสู่เมนูหลัก
                        </button>
                    </div>
                </div>
            `;
        }

        // --- FOCUS MANAGEMENT ---
        function focusOnHeading() {
            setTimeout(() => {
                const heading = document.getElementById(state.view === 'playing' ? 'situation-heading' : 'result-heading');
                if (heading) heading.focus();
            }, 2000);
        }

        // --- GAME LOGIC ---

        async function startGame() {
            await preloadAudio(); // Preload audio on start
            playAudio('back.mp3', true); // Start BGM loop
            state.level = 1;
            state.missionIndex = 0;
            state.score = 0;
            state.view = 'playing';
            loadMission();
        }

        function loadMission() {
            const scenario = GAME_DATA[state.level - 1].missions[state.missionIndex];
            state.currentScenario = scenario;
            state.shuffledOptions = shuffleArray([...scenario.options]);
            renderGame();
            focusOnHeading();
        }

        function handleChoice(option) {
            if (option.correct) {
                // Calculate total missions completed
                const totalMissions = (state.level - 1) * 5 + state.missionIndex + 1;

                if (totalMissions < 50) {
                    playAudio('pass.mp3'); // Play pass for 1-49
                }

                // Correct
                state.score += 100;
                
                if (state.missionIndex < 4) {
                    // Next mission in same level
                    state.missionIndex++;
                    loadMission();
                } else {
                    // Level Complete
                    if (state.level < 10) {
                        state.level++;
                        state.missionIndex = 0;
                        loadMission();
                    } else {
                        // Game Won
                        playAudio('win.mp3'); // Play win on 50th correct
                        stopAudio('back.mp3'); // Stop BGM
                        state.view = 'victory';
                        renderVictory();
                        focusOnHeading();
                    }
                }
            } else {
                // Wrong = Game Over
                playAudio('lost.mp3'); // Play lost
                stopAudio('back.mp3'); // Stop BGM
                state.deathReason = option.deathMsg || "คุณตัดสินใจผิดพลาด เครื่องบินระเบิดทันที";
                state.view = 'gameover';
                renderGameOver();
                focusOnHeading();
            }
        }

        function resetToMenu() {
            playAudio('home.mp3'); // Play home sound
            state.view = 'menu';
            renderMenu();
        }

        // Initialize
        renderMenu();

    </script>
</body>
</html>