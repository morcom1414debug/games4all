<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shadow of Retribution: เงาแค้นแห่งความตาย</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap');

        body {
            background-color: #050505;
            color: #dcdcdc;
            font-family: 'Sarabun', sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        #game-container {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
        }

        /* ปุ่มกลับสู่ชุมชน */
        #community-btn {
            position: absolute;
            top: -50px;
            left: 0;
            width: auto;
            padding: 8px 15px;
            font-size: 0.9rem;
            display: none; /* เปิดเฉพาะหน้าแรกและสรุป */
        }

        /* Introduction & Menu */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            text-align: center;
            animation: fadeIn 0.5s ease-in-out;
        }

        .active {
            display: flex;
        }

        h3.main-title {
            font-size: 2.2rem;
            color: #ff3333;
            text-shadow: 0 0 10px #800000;
            margin-bottom: 5px;
            line-height: 1.2;
            outline: none;
        }

        h3.game-over-title {
            font-size: 2.5rem;
            color: darkred;
            margin-bottom: 10px;
            outline: none;
        }

        h3.win-title {
            font-size: 2.5rem;
            color: #4CAF50;
            margin-bottom: 10px;
            outline: none;
        }

        .stage-title {
            font-size: 1.5rem;
            color: #ff3333;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            border-bottom: 1px solid #330000;
            width: 100%;
            text-align: left;
            padding-bottom: 5px;
            outline: none;
        }

        .mission-title {
            font-size: 1.3rem;
            color: #ffaaaa;
            margin-bottom: 20px;
            width: 100%;
            text-align: left;
            font-weight: bold;
            outline: none;
        }

        p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
            color: #cccccc;
        }

        .highlight {
            color: #ff3333;
            font-weight: bold;
        }

        button {
            background: #1a1a1a;
            color: #ffffff;
            border: 1px solid #ff3333;
            padding: 15px 30px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Sarabun', sans-serif;
            border-radius: 5px;
            margin: 10px 0;
            width: 100%;
            max-width: 600px;
        }

        button:hover {
            background: #330000;
            box-shadow: 0 0 15px rgba(255, 51, 51, 0.4);
            transform: scale(1.02);
        }

        .choice-btn {
            text-align: center;
            margin: 8px 0;
            display: block;
        }

        #story-text {
            text-align: left;
            margin-bottom: 30px;
            padding: 20px;
            background: #111;
            border-left: 3px solid #ff3333;
            border-radius: 0 5px 5px 0;
            font-size: 1.2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        .shake-screen {
            animation: shake 0.5s;
        }

        .red-overlay {
            color: #ff0000;
            font-weight: bold;
            font-size: 1.5rem;
        }
    </style>
</head>
<body>

<div id="game-container">
    <button id="community-btn" onclick="window.location.href='../index.html'" style="display: block;">กลับสู่ชุมชน</button>

    <div id="start-screen" class="screen active">
        <h3 id="main-title-heading" class="main-title" tabindex="-1">Shadow of Retribution:<br>เงาแค้นแห่งความตาย</h3>
        <p>
            คาสิโนเฮดีสกลายเป็นเถ้าถ่าน... แต่คุณคิดผิดที่เชื่อว่ามันจบลงแล้ว<br>
            "ยมทูต" เป็นเพียงหมากตัวหนึ่ง...<br>
            <strong>ผู้อยู่เบื้องหลังที่แท้จริงคือ...</strong><br>
            และตอนนี้... <strong>คุณคือผู้ถูกล่า</strong>
        </p>
        <div style="background: #111; padding: 20px; border: 1px solid #444; margin-bottom: 20px; text-align: left;">
            <h3 style="color:#ff3333; margin-top:0;">⚠️ กฎการเล่น (โปรดอ่าน)</h3>
            <ul>
                <li>เกมมีทั้งหมด <strong>10 ด่าน (Stage)</strong></li>
                <li>แต่ละด่านมี <strong>5 ภารกิจ (Mission)</strong></li>
                <li>คุณต้องเลือก 1 ข้อที่ถูกต้องจาก 4 ตัวเลือก</li>
                <li>คุณต้องอ่านสถานการณ์และวิเคราะห์ด้วยตรรกะของสายลับ</li>
                <li><span class="highlight">หากเลือกผิด: คุณจะถูกสังหารทันที และต้องเริ่มเกมใหม่ตั้งแต่ต้น!</span></li>
            </ul>
        </div>
        <button onclick="startGame()">เริ่มเกม</button>
    </div>

    <div id="game-screen" class="screen">
        <h3 id="current-stage-title" class="stage-title" tabindex="-1">Stage Name</h3>
        <h3 id="current-mission-title" class="mission-title" tabindex="-1">Mission Name</h3>
        <div id="story-text">Loading...</div>
        <div id="choices-container"></div>
    </div>

    <div id="game-over-screen" class="screen">
        <h3 id="game-over-heading" class="game-over-title" tabindex="-1">ภารกิจล้มเหลว</h3>
        <p class="red-overlay">คุณเสียชีวิต</p>
        <p id="death-reason" style="font-style: italic; color: #aaa;"></p>
        <button onclick="resetGame()">เริ่มใหม่ตั้งแต่ต้น</button>
    </div>

    <div id="win-screen" class="screen">
        <h3 id="win-heading" class="win-title" tabindex="-1">ภารกิจสมบูรณ์</h3>
        <p>
            คุณจัดการ "ผู้อยู่เบื้องหลัง" ได้สำเร็จ ข้อมูลเครือข่ายทั้งหมดถูกเปิดโปง<br>
            องค์กรล่มสลายอย่างแท้จริง คุณยืนมองแสงอาทิตย์ขึ้นเหนือเมืองที่ปลอดภัยแล้ว<br>
            เงาแค้นได้จางหายไป... คุณเป็นอิสระ
        </p>
        <br>
        <button onclick="resetGame()">เล่นอีกครั้ง</button>
    </div>
</div>

<script>
    // --- Web Audio API Setup ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const audioBuffers = {};

    async function loadAudio(name, url) {
        try {
            const response = await fetch(url);
            const arrayBuffer = await response.arrayBuffer();
            audioBuffers[name] = await audioCtx.decodeAudioData(arrayBuffer);
        } catch (e) { console.error("Error loading audio:", url); }
    }

    // Load initial audios
    loadAudio('back', 'audio/back.mp3');
    loadAudio('lost', 'audio/lost.mp3');
    loadAudio('t', 'audio/t.mp3');
    loadAudio('win', 'audio/win.mp3');

    let bgmSource = null;
    let sfxSource = null;

    function playBGM() {
        stopBGM();
        if (!audioBuffers['back']) return;
        bgmSource = audioCtx.createBufferSource();
        bgmSource.buffer = audioBuffers['back'];
        bgmSource.loop = true;
        bgmSource.connect(audioCtx.destination);
        bgmSource.start(0);
    }

    function stopBGM() {
        if (bgmSource) {
            bgmSource.stop();
            bgmSource = null;
        }
    }

    function playSFX(name, callback) {
        stopSFX();
        if (!audioBuffers[name]) return;
        sfxSource = audioCtx.createBufferSource();
        sfxSource.buffer = audioBuffers[name];
        sfxSource.connect(audioCtx.destination);
        sfxSource.onended = callback;
        sfxSource.start(0);
    }

    function stopSFX() {
        if (sfxSource) {
            sfxSource.stop();
            sfxSource = null;
        }
    }

    // --- GAME DATA ---
const gameData = [
        {
            title: "STAGE 1: THE AFTERMATH (เอาชีวิตรอดจากซากปรักหักพัง)",
            missions: [
                {
                    title: "Mission 1: วิกฤตควันพิษ",
                    text: "หลังเสียงระเบิด 'ตูมมมม!' คาสิโนถล่มลงมา คุณรอดตายหวุดหวิดแต่ติดอยู่ในซากปรักหักพังชั้นใต้ดิน มีควันไฟและแก๊สรั่วไหล เสียงฝีเท้าหนักๆ ของหน่วยเก็บกวาด 'Cleaners' กำลังใกล้เข้ามา พวกมันสวมหน้ากากกันแก๊ส คุณไม่มีหน้ากาก คุณต้องรีบออกจากจุดนี้",
                    choices: ["วิ่งฝ่าควันออกไปทางประตูหลัก", "ใช้ผ้าปิดจมูกแล้วคลานต่ำไปตามท่อระบายอากาศที่พัง", "ยิงปืนขึ้นฟ้าเพื่อล่อความสนใจแล้วซุ่มโจมตี", "ปาระเบิดใส่ผนังเพื่อสร้างทางออกใหม่"],
                    correct: 1,
                    deaths: [
                        "ประตูหลักมีหน่วย Cleaners ดักอยู่เต็มไปหมด คุณถูกรุมยิงพรุนทันทีที่โผล่ออกไป", 
                        null, 
                        "เสียงปืนบอกตำแหน่งของคุณชัดเจน พวกมันโยนระเบิดมือเข้ามาแทนที่จะเดินเข้ามาหาคุณ", 
                        "แรงระเบิดทำให้เพดานที่ร้าวอยู่แล้วถล่มลงมาทับคุณเสียชีวิตคาที่"
                    ]
                },
                {
                    title: "Mission 2: หน่วยเก็บกวาด",
                    text: "คุณออกมาจากท่อระบายอากาศได้ แต่เจอกับหน่วย Cleaners 2 คนกำลังยืนหันหลังคุยกันอยู่ พวกมันสวมเกราะหนักกันกระสุนที่ลำตัว คุณมีกระสุนจำกัดและมีดพก",
                    choices: ["ใช้ปืนยิงกราดใส่กลางลำตัว", "ปาระเบิดมือใส่พวกมันทันที", "ย่องเข้าไปใช้มีดปาดคอทีละคน", "เล็งยิงที่ศีรษะทีละคนอย่างใจเย็น"],
                    correct: 3, 
                    deaths: [
                        "กระสุนปืนพกเจาะเกราะหนักไม่เข้า พวกมันหันกลับมายิงสวนคุณด้วยปืนกลหนัก",
                        "ระยะห่างน้อยเกินไป แรงระเบิดและเศษสะเก็ดกระเด็นมาโดนคุณเสียชีวิตไปด้วย",
                        "ชุดเกราะของพวกมันมีแผงคอป้องกัน (Neck Guard) มีดของคุณแทงไม่เข้าและถูกจับทุ่มลงพื้น",
                        null
                    ]
                },
                {
                    title: "Mission 3: ทางขึ้นที่อันตราย",
                    text: "คุณพบทางขึ้นสู่พื้นดิน แต่บันไดพังถล่ม มีเพียงลิฟต์ขนของที่ยังดูเหมือนใช้งานได้ แต่ไฟกระพริบ และมีกล่องควบคุมวงจรเปิดอยู่",
                    choices: ["กดเรียกลิฟต์ทันที", "ปีนสายสลิงในปล่องลิฟต์ขึ้นไป", "สับสวิตช์มั่วๆ เพื่อรีเซ็ตระบบ", "ใช้อุปกรณ์กู้ระเบิดดัดแปลงวงจรลิฟต์ให้ทำงาน"],
                    correct: 1, 
                    deaths: [
                        "ลิฟต์ถูกวางกับดักไว้ ทันทีที่คุณกดปุ่ม ลิฟต์ระเบิดใส่หน้าคุณ",
                        null,
                        "การสับสวิตช์มั่วๆ ทำให้เกิดไฟลัดวงจรอย่างรุนแรง ไฟคลอกคุณเสียชีวิต",
                        "คุณใช้เวลานานเกินไปในการดัดแปลงวงจร แก๊สพิษจากด้านล่างลอยขึ้นมาและรมคุณจนตาย"
                    ]
                },
                {
                    title: "Mission 4: สายตาจักรกล",
                    text: "คุณปีนขึ้นมาเกือบถึงชั้นบนสุด เจอโดรนลาดตระเวนขนาดเล็กบินลงมาส่องไฟหาผู้รอดชีวิต มันมีปืนกลติดอยู่",
                    choices: ["หยุดนิ่งแล้วทำตัวกลมกลืนกับผนัง", "ใช้ปืนยิงโดรนให้ร่วงทันที", "กระโดดเกาะโดรน", "ปามีดใส่ใบพัดโดรน"],
                    correct: 0, 
                    deaths: [
                        null,
                        "โดรนระเบิดใส่หน้าคุณ แรงระเบิดทำให้คุณร่วงลงสู่ปล่องลิฟต์",
                        "โดรนรับน้ำหนักคุณไม่ไหว ทั้งคุณและโดรนร่วงลงไปกระแทกพื้นด้านล่างตายคาที่",
                        "คุณปามีดพลาดไปโดนตัวถังโดรน เสียงกระทบทำให้โดรนรู้ตัวและกราดยิงคุณ"
                    ]
                },
                {
                    title: "Mission 5: สไนเปอร์ใต้แสงจันทร์",
                    text: "คุณขึ้นมาถึงซากล็อบบี้ แสงจันทร์ส่องลงมา แต่มีสไนเปอร์ซุ่มอยู่บนตึกตรงข้าม คุณเห็นแสงสะท้อนจากเลนส์",
                    choices: ["วิ่งซิกแซกออกไป", "ปาระเบิดควัน (Smell Bomb) เพื่อพรางตัว", "ใช้กระจกเงาจากซากปรักหักพังสะท้อนแสงกลับไป", "หมอบคลานต่ำไปเรื่อยๆ"],
                    correct: 2, 
                    deaths: [
                        "สไนเปอร์ระดับพระกาฬไม่พลาดเป้าเคลื่อนที่ คุณถูกยิงเข้ากลางศีรษะ",
                        "คุณไม่มีระเบิดควันในกระเป๋า! การเสียเวลาค้นหาทำให้สไนเปอร์เห็นตัวคุณและยิงทันที",
                        null,
                        "การคลานช้าเกินไป สไนเปอร์ยิงทะลุกำแพงบางๆ ที่คุณใช้กำบังอยู่"
                    ]
                }
            ]
        },
        {
            title: "STAGE 2: THE SEWERS (ทางระบายน้ำใต้ดิน)",
            missions: [
                {
                    title: "Mission 1: ทางแยกมรณะ",
                    text: "คุณหนีลงท่อระบายน้ำเพื่อหลบสไนเปอร์ น้ำเน่าเหม็นสูงถึงเข่า ข้างหน้ามีทางแยกซ้ายและขวา ทางซ้ายมีกลิ่นสารเคมีรุนแรง ทางขวามีเสียงน้ำไหลแรงผิดปกติ",
                    choices: ["ไปทางซ้าย", "ไปทางขวา", "จุดไฟแช็กเพื่อดูทาง", "เดินย้อนกลับไปทางเดิม"],
                    correct: 1, 
                    deaths: [
                        "กลิ่นสารเคมีนั้นคือแก๊สพิษเข้มข้น คุณสำลักและล้มลงขาดใจตายในไม่กี่วินาที",
                        null,
                        "ในท่อเต็มไปด้วยแก๊สมีเทน ประกายไฟเพียงนิดเดียวทำให้ท่อระบายน้ำระเบิดเป็นจุล",
                        "สไนเปอร์จากด่านที่แล้วดักรอคุณอยู่ที่ปากทางเข้า เขาเป่าหัวคุณทันทีที่ย้อนกลับไป"
                    ]
                },
                {
                    title: "Mission 2: อสูรกายใต้น้ำ",
                    text: "จระเข้เผือกขนาดใหญ่ที่หลุดจากการทดลองของ Hades พุ่งเข้าหาคุณในน้ำ",
                    choices: ["ยิงปืนใส่ตามตัวมัน", "กระโดดขึ้นท่อพักน้ำด้านบน", "ใช้มีดแทงสวน", "ปาระเบิดลงน้ำ"],
                    correct: 1, 
                    deaths: [
                        "เกล็ดมันหนาเกินไป กระสุนทำอะไรไม่ได้ มันงับขาคุณและลากลงใต้น้ำ",
                        null,
                        "ระยะประชิดในน้ำคุณเสียเปรียบอย่างมาก มันสะบัดคุณหลุดและฉีกร่างคุณเป็นชิ้นๆ",
                        "แรงอัดของระเบิดในน้ำ (Hydraulic Shockwave) รุนแรงกว่าบนบกมาก อวัยวะภายในคุณฉีกขาดทันที"
                    ]
                },
                {
                    title: "Mission 3: ประตูนิรภัยเก่า",
                    text: "คุณพบประตูเหล็กปิดล็อกอยู่ มันเป็นประตูนิรภัยรุ่นเก่า สนิมเขรอะ มีแม่กุญแจคล้องอยู่",
                    choices: ["ใช้ปืนยิงแม่กุญแจ", "ใช้ระเบิดทำลายประตู", "ใช้มีดงัดแงะ", "หาก้อนหินทุบ"],
                    correct: 0, 
                    deaths: [
                        null,
                        "พื้นที่แคบเกินไป แรงระเบิดสะท้อนกลับมาอัดร่างคุณกระแทกผนังเสียชีวิต",
                        "ใบมีดหักคาแม่กุญแจ และเสียงแกรกกรากทำให้ศัตรูหลังประตูรู้ตัวและยิงทะลุประตูออกมา",
                        "ก้อนหินทำอะไรแม่กุญแจเหล็กไม่ได้ คุณหมดแรงเปล่าและถูกจระเข้ตามมาทัน"
                    ]
                },
                {
                    title: "Mission 4: เจ้าถิ่น",
                    text: "หลังประตูคือรังของพวกนักเลงเจ้าถิ่น พวกมันเห็นคุณและชักมีดออกมา 3 คน",
                    choices: ["ยิงทิ้งให้หมด", "เจรจาขอผ่านทาง", "ท้าดวลตัวต่อตัว", "วิ่งหนี"],
                    correct: 0, 
                    deaths: [
                        null,
                        "พวกมันไม่สนใจคำพูดของคุณและพุ่งเข้ามาแทงคุณพร้อมกัน",
                        "นี่ไม่ใช่หนังคาวบอย อีกสองคนที่เหลือเข้ามาล็อคแขนคุณเพื่อให้หัวหน้าแทง",
                        "คุณหันหลังให้ศัตรู มีดบินปักกลางหลังคุณ คุณล้มลงและถูกรุมสังหาร"
                    ]
                },
                {
                    title: "Mission 5: ทางออกที่ถูกปิดกั้น",
                    text: "คุณเจอทางออกสู่แม่น้ำ แต่มีตะแกรงเหล็กกั้น น้ำกำลังเพิ่มระดับขึ้นเรื่อยๆ",
                    choices: ["ดำน้ำลงไปดูฐานตะแกรง", "ใช้ระเบิดแปะที่ตะแกรง", "ตะโกนขอความช่วยเหลือ", "ใช้ปืนยิงตะแกรง"],
                    correct: 1, 
                    deaths: [
                        "น้ำขุ่นเกินไป คุณมองไม่เห็นอะไรและขาดอากาศหายใจตายใต้น้ำ",
                        null,
                        "เสียงตะโกนเรียกศัตรูที่อยู่ด้านบน พวกมันโยนระเบิดลงมาในท่อ",
                        "กระสุนแฉลบเหล็กตะแกรงกลับมาโดนตัวคุณเองในที่แคบ"
                    ]
                }
            ]
        },
        {
            title: "STAGE 3: CITY STREETS (ถนนในเมือง - ผู้ถูกล่า)",
            missions: [
                {
                    title: "Mission 1: หายานพาหนะ",
                    text: "คุณขึ้นมาบนถนนยามค่ำคืน ฝนตกหนัก มีประกาศจับใบหน้าคุณบนจอ LED ทั่วเมือง ตำรวจและนักฆ่าอิสระกำลังตามหาคุณ คุณต้องหารถ",
                    choices: ["ขโมยรถสปอร์ตหรูที่จอดอยู่", "ขโมยรถเก่าๆ บุโรทั่ง", "เรียกรถแท็กซี่", "วิ่งไปเรื่อยๆ"],
                    correct: 1, 
                    deaths: [
                        "รถหรูมีระบบกันขโมยดาวเทียม เครื่องยนต์ดับเองและล็อคประตูขังคุณไว้รอตำรวจมาจับ",
                        null,
                        "คนขับแท็กซี่จำหน้าคุณได้จากข่าว เขาแอบกดปุ่มแจ้งตำรวจและพาคุณไปส่งที่โรงพัก",
                        "คนวิ่งไม่มีทางหนีทันเครือข่ายกล้องวงจรปิด คุณถูกหน่วยไล่ล่าล้อมจับในซอยตัน"
                    ]
                },
                {
                    title: "Mission 2: การไล่ล่าบนถนน",
                    text: "ขณะขับรถ คุณถูกประกบด้วยมอเตอร์ไซค์นักฆ่า 2 คัน พวกมันเล็งปืนใส่กระจก",
                    choices: ["เบรกกะทันหัน", "เหยียบคันเร่งหนี", "หักพวงมาลัยชนพวกมัน", "ยิงสวนผ่านกระจก"],
                    correct: 2, 
                    deaths: [
                        "เบรกกะทันหันทำให้พวกมันเลยไปก็จริง แต่พวกมันยิงสวนกลับมาที่กระจกหน้าได้ง่ายขึ้น",
                        "มอเตอร์ไซค์คล่องตัวกว่าในสภาพการจราจรหนาแน่น พวกมันไล่ทันและยิงล้อรถคุณแตก",
                        null,
                        "การขับมือเดียวและยิงสวนทำให้รถเสียหลักพุ่งชนเสาไฟฟ้าอย่างรุนแรง"
                    ]
                },
                {
                    title: "Mission 3: ซ่อนตัว",
                    text: "รถคุณเสียหลักชนเสาไฟฟ้า คุณต้องหนีเข้าห้างสรรพสินค้าที่ปิดแล้ว ยามเฝ้าประตูเดินมาตรวจ",
                    choices: ["ยิงยามทิ้ง", "ซ่อนหลังถังขยะ", "แกล้งตาย", "วิ่งชนกระจกเข้าไป"],
                    correct: 1, 
                    deaths: [
                        "เสียงปืนดึงดูดความสนใจของตำรวจที่อยู่ใกล้เคียง ห้างถูกล้อมทันที",
                        null,
                        "ยามเข้ามาตรวจสอบชีพจรและพบว่าคุณยังไม่ตาย เขาวิทยุเรียกกำลังเสริมทันที",
                        "กระจกนิรภัยแข็งกว่าที่คุณคิด คุณชนแล้วกระเด้งกลับมาสลบคาที่"
                    ]
                },
                {
                    title: "Mission 4: หน่วยล่าสังหารพิเศษ",
                    text: "ในห้างมืดสนิท คุณได้ยินเสียงฝีเท้าเบาๆ ของ 'หน่วยไล่ล่าพิเศษ' พวกมันใส่แว่น Night Vision",
                    choices: ["เปิดไฟฉายมือถือ", "ขว้างของไปทิศตรงข้าม", "เดินชิดผนังเงียบๆ", "เปิดสวิตช์ไฟหลักของห้าง"],
                    correct: 3, 
                    deaths: [
                        "แสงไฟฉายกลายเป็นเป้านิ่งให้พวกมันยิงสวนมาทันที",
                        "พวกมันเป็นมืออาชีพ ไม่หลงกลง่ายๆ และจับทิศทางเสียงการขว้างของคุณได้",
                        "แว่น Night Vision มองเห็นความร้อนจากร่างกายคุณ คุณถูกยิงตายโดยไม่รู้ตัว",
                        null
                    ]
                },
                {
                    title: "Mission 5: ฝ่าวงล้อม",
                    text: "คุณเจอทางออกหลังห้าง แต่มีรถตู้สีดำจอดขวางอยู่ ประตูรถเปิดออก",
                    choices: ["ยิงถล่มใส่รถตู้", "วิ่งกลับเข้าห้าง", "ปาระเบิดเข้าไปในรถ", "อ้อมไปอีกทาง"],
                    correct: 2, 
                    deaths: [
                        "คุณยิงไม่โดนใครเลย เพราะศัตรูใช้ประตูรถกันกระสุนเป็นที่กำบังและยิงสวน",
                        "ในห้างเต็มไปด้วยหน่วยล่าสังหาร การกลับเข้าไปคือการฆ่าตัวตาย",
                        null,
                        "ทางอ้อมทำให้คุณเสียเวลา หน่วยสไนเปอร์ที่ดักอยู่ยิงคุณจากระยะไกล"
                    ]
                }
            ]
        },
        {
            title: "STAGE 4: SAFE HOUSE (เซฟเฮาส์ที่ไม่ปลอดภัย)",
            missions: [
                {
                    title: "Mission 1: รหัสผ่าน",
                    text: "คุณมาถึงเซฟเฮาส์ลับ ประตูล็อคด้วยรหัส คุณจำรหัสได้รางๆ ว่าเกี่ยวกับวันตายของยมทูตในภาคแรก",
                    choices: ["0000", "1234", "ใส่วันที่ปัจจุบัน", "ใช้ระเบิดเปิดประตู"],
                    correct: 2, 
                    deaths: [
                        "รหัสผิด! ระบบรักษาความปลอดภัยปล่อยกระแสไฟฟ้าแรงสูงช็อตคุณเสียชีวิตหน้าประตู",
                        "รหัสผิด! ป้อมปืนอัตโนมัติบนเพดานทำงานและกราดยิงคุณ",
                        null,
                        "ประตูเซฟเฮาส์เสริมเหล็กกล้า แรงระเบิดทำลายประตูไม่ได้แต่ทำลายตัวคุณเอง"
                    ]
                },
                {
                    title: "Mission 2: กับดักระเบิด",
                    text: "เข้ามาในห้อง คุณพบว่าข้าวของถูกรื้อค้น มีระเบิดเวลาติดตั้งอยู่ที่ใต้โต๊ะ เหลือเวลา 10 วินาที",
                    choices: ["ตัดสายสีแดง", "ตัดสายสีน้ำเงิน", "วิ่งกระโดดออกทางหน้าต่าง", "โยนระเบิดเข้าห้องน้ำ"],
                    correct: 2, 
                    deaths: [
                        "ตูม! คุณตัดผิดสาย ระเบิดทำงานทันที",
                        "ตูม! คุณตัดผิดสาย ระเบิดทำงานทันที",
                        null,
                        "แรงระเบิดรุนแรงเกินกว่าผนังห้องน้ำจะกันอยู่ ตึกถล่มลงมาทับคุณ"
                    ]
                },
                {
                    title: "Mission 3: บาดเจ็บและจนมุม",
                    text: "คุณกระโดดลงมาที่ถังขยะ รอดตายแต่บาดเจ็บ ศัตรูรู้ตำแหน่งแล้วและกำลังล้อมตึก",
                    choices: ["ปฐมพยาบาลก่อน", "ฉีดยากระตุ้น adrenaline แล้วลุย", "แอบในถังขยะต่อ", "ยอมมอบตัว"],
                    correct: 1, 
                    deaths: [
                        "คุณมัวแต่พันแผล หน่วยจู่โจมบุกเข้ามาถึงตัวและยิงคุณทิ้ง",
                        null,
                        "ศัตรูไม่ตรวจค้น แต่ใช้วิธีกราดยิงถังขยะทุกใบ คุณตายคาถังขยะ",
                        "องค์กรนี้ไม่รับเชลย ทันทีที่คุณยกมือยอมแพ้ คุณก็ถูกยิงเจาะกะโหลก"
                    ]
                },
                {
                    title: "Mission 4: กับดักยานพาหนะ",
                    text: "มีรถมอเตอร์ไซค์ของศัตรูจอดอยู่ กุญแจเสียบคาไว้",
                    choices: ["สตาร์ทรถขี่หนี", "ตัดสายเบรกแล้วเข็นไปล่อเป้า", "ตรวจสอบระเบิดที่รถก่อน", "ขโมยน้ำมันมาทำระเบิดเพลิง"],
                    correct: 2, 
                    deaths: [
                        "กับดักทำงาน! ระเบิด C4 ใต้เบาะรถระเบิดร่างคุณเป็นจุณทันทีที่บิดกุญแจ",
                        "รถไม่ได้ถูกวางระเบิดที่สายเบรก แต่ที่ระบบสตาร์ท แผนล่อเป้าล้มเหลวและคุณถูกจับได้",
                        null,
                        "คุณเสียเวลาดูดน้ำมันนานเกินไป ศัตรูตามมาทันและยิงคุณจากด้านหลัง"
                    ]
                },
                {
                    title: "Mission 5: หนีทางอากาศ",
                    text: "หลังกู้ระเบิดรถได้ คุณขี่หนีมุ่งหน้าไปท่าเรือ แต่มี เฮลิคอปเตอร์ไล่ตามมายิงกราด",
                    choices: ["ขับซิกแซกบนถนนใหญ่", "ขับเข้าอุโมงค์ใต้ดิน", "หยุดรถแล้วยิงสู้", "ขับลงน้ำ"],
                    correct: 1, 
                    deaths: [
                        "บนถนนโล่ง คุณเป็นเป้านิ่งให้ปืนกลหนักบนเฮลิคอปเตอร์ยิงถล่ม",
                        null,
                        "ปืนพกของคุณทำอะไรเฮลิคอปเตอร์หุ้มเกราะไม่ได้ คุณถูกจรวดมิสไซล์ยิงใส่",
                        "มอเตอร์ไซค์จมน้ำ คุณว่ายน้ำช้าเกินไปและถูกยิงตายในน้ำ"
                    ]
                }
            ]
        },
        {
            title: "STAGE 5: THE HARBOR (ท่าเรือขนส่งสินค้า)",
            missions: [
                {
                    title: "Mission 1: ฐานบัญชาการเคลื่อนที่",
                    text: "ที่ท่าเรือ ตู้คอนเทนเนอร์วางเรียงราย คุณรู้ว่า 'ผู้อยู่เบื้องหลัง' ซ่อนฐานบัญชาการเคลื่อนที่ไว้ในเรือลำหนึ่ง",
                    choices: ["วิ่งไปที่เรือใหญ่ที่สุด", "จับลูกเรือมาสอบปากคำ", "ปีนขึ้นเครนเพื่อส่องดูลาดเลา", "สุ่มตรวจตู้คอนเทนเนอร์"],
                    correct: 2, 
                    deaths: [
                        "เรือลำใหญ่มีการป้องกันหนาแน่นที่สุด คุณถูกป้อมปืนยิงตายก่อนถึงบันไดเรือ",
                        "ลูกเรือตะโกนโวยวายขอความช่วยเหลือ ยามแห่กันมารุมคุณ",
                        null,
                        "ตู้คอนเทนเนอร์มีเป็นพันตู้ คุณเสียเวลาเปล่าจนกระทั่งถูกยามลาดตระเวนมาเจอ"
                    ]
                },
                {
                    title: "Mission 2: ลอบขึ้นเรือ",
                    text: "บนเครน คุณเห็นเรือสินค้าลำหนึ่งมีการคุ้มกันแน่นหนา แต่ทางลงถูกดักโดยยาม 2 คน",
                    choices: ["โรยตัวด้วยเชือกลงไปด้านหลังพวกมัน", "ใช้สไนเปอร์ไรเฟิลที่ยึดมาได้ยิงเก็บ", "กระโดดลงน้ำ", "โยนเหรียญล่อความสนใจ"],
                    correct: 0, 
                    deaths: [
                        null,
                        "เสียงปืนไรเฟิลดังลั่นท่าเรือ ยามทั้งกองทัพแห่กันมาหาคุณ",
                        "ความสูงระดับนี้ การกระโดดลงน้ำเปรียบเสมือนกระโดดลงคอนกรีต คุณกระดูกหักตาย",
                        "เสียงเหรียญเบาเกินไปในท่าเรือที่มีเสียงเครื่องจักร ยามไม่สนใจและเห็นตัวคุณตอนปีนลงมา"
                    ]
                },
                {
                    title: "Mission 3: เขาวงกต",
                    text: "คุณลอบขึ้นเรือได้สำเร็จ ต้องหาห้องควบคุม แต่เรือกว้างมาก",
                    choices: ["เดินตามสายไฟเส้นใหญ่", "ไปที่ดาดฟ้าเรือ", "ลงไปห้องเครื่อง", "บุกเข้าห้องกัปตัน"],
                    correct: 0, 
                    deaths: [
                        null,
                        "ดาดฟ้าเรือโล่งเกินไป สไนเปอร์บนหอคอยส่องเห็นคุณและยิงทันที",
                        "ห้องเครื่องเสียงดังและร้อนจัด คุณหน้ามืดและตกลงไปในใบพัดเครื่องยนต์",
                        "ห้องกัปตันมีกับดักระเบิดที่หน้าประตู คุณโดนระเบิดเสียชีวิต"
                    ]
                },
                {
                    title: "Mission 4: ระบบเลเซอร์",
                    text: "พบห้องเซิร์ฟเวอร์สำรอง มีระบบป้องกันด้วยเลเซอร์",
                    choices: ["ใช้ควันบุหรี่พ่นหาลำแสง", "กลิ้งตัวผ่านไปเร็วๆ", "ตัดไฟทั้งลำเรือ", "ใช้กระจกสะท้อนเลเซอร์"],
                    correct: 0, 
                    deaths: [
                        null,
                        "คุณไม่เร็วพอ ร่างกายสัมผัสเลเซอร์ ป้อมปืนอัตโนมัติทำงานยิงคุณพรุน",
                        "การตัดไฟทำให้ระบบล็อคประตูฉุกเฉินทำงาน คุณติดอยู่ในเรือและขาดอากาศหายใจ",
                        "กระจกทำให้ลำแสงหักเหไปโดนเซ็นเซอร์อื่น ระเบิดเพลิงทำงานเผาคุณทั้งเป็น"
                    ]
                },
                {
                    title: "Mission 5: ข้อมูลที่แท้จริง",
                    text: "ข้อมูลในเซิร์ฟเวอร์ระบุว่า ฐานจริงคือ 'รถไฟหุ้มเกราะ' ที่กำลังจะออกจากสถานีใกล้ๆ นี้",
                    choices: ["ทำลายเรือทิ้ง", "รีบหนีออกจากเรือไปสถานีรถไฟ", "ส่งข้อมูลให้ตำรวจ", "ซ่อนตัวรอเรือออก"],
                    correct: 1, 
                    deaths: [
                        "คุณมัวแต่ติดตั้งระเบิด รถไฟขบวนเป้าหมายออกจากสถานีไปแล้ว ภารกิจล้มเหลว",
                        null,
                        "ตำรวจในเมืองนี้ถูกซื้อตัวไว้หมดแล้ว ข้อมูลถูกลบและตำแหน่งคุณถูกเปิดเผย",
                        "เรือลำนี้เป็นแค่นกต่อ มันแล่นออกสู่ทะเลลึกและจมตัวเองพร้อมกับคุณ"
                    ]
                }
            ]
        },
        {
            title: "STAGE 6: THE ARMORED TRAIN (รถไฟหุ้มเกราะ)",
            missions: [
                {
                    title: "Mission 1: เกาะท้ายขบวน",
                    text: "คุณขี่มอเตอร์ไซค์ไล่กวดรถไฟหุ้มเกราะ และกระโดดเกาะท้ายขบวนได้สำเร็จ ทหารยามเฝ้าประตูท้ายอยู่",
                    choices: ["ยิงทะลุประตูเข้าไป", "ปีนขึ้นหลังคารถไฟ", "เคาะประตูเรียก", "ใช้มีดงัดประตู"],
                    correct: 1, 
                    deaths: [
                        "ประตูกันกระสุน! กระสุนแฉลบกลับมาโดนรถมอเตอร์ไซค์ระเบิด",
                        null,
                        "ทหารยามได้ยินเสียงเคาะ เขาเปิดช่องยิงและกราดปืนกลใส่คุณ",
                        "มีดของคุณหักคามือ ประตูรถไฟแข็งแกร่งเกินไป คุณพลัดตกลงจากรถไฟ"
                    ]
                },
                {
                    title: "Mission 2: บนหลังคารถไฟ",
                    text: "บนหลังคารถไฟ ลมแรงมาก มีทหารยามเดินตรวจการณ์สวนมา",
                    choices: ["ยืนยิงวัดกันไปเลย", "หมอบราบไปกับหลังคาและรอจังหวะ", "กระโดดข้ามตู้รถไฟหนี", "โหนตัวลงด้านข้างตู้"],
                    correct: 3, 
                    deaths: [
                        "ลมแรงทำให้วิถีกระสุนคุณพลาดเป้า แต่ศัตรูใช้ปืนกลที่มีขาตั้งยิงคุณร่วง",
                        "บนหลังคาไม่มีที่กำบัง ศัตรูเห็นคุณนอนอยู่และยิงซ้ำง่ายๆ",
                        "ระยะห่างระหว่างตู้รถไฟกว้างเกินไป คุณกระโดดไม่พ้นและตกลงไปบดกับรางรถไฟ",
                        null
                    ]
                },
                {
                    title: "Mission 3: ตู้เสบียง",
                    text: "คุณเข้ามาในตู้เสบียง พบศัตรูกำลังกินอาหาร 4 คน อาวุธวางอยู่ไกลตัว",
                    choices: ["กราดยิงทันที", "ปาระเบิดเข้าไป", "ใช้มีดวิ่งเข้าไปแทง", "ล็อคประตูขังพวกมันไว้"],
                    correct: 1, 
                    deaths: [
                        "คุณยิงเก็บได้ไม่หมด คนที่เหลือหยิบปืนใต้โต๊ะยิงสวนคุณ",
                        null,
                        "ระยะทางไกลเกินไป พวกมันไหวตัวทันและรุมสู้จนคุณแพ้",
                        "ประตูรถไฟเป็นระบบอัตโนมัติ พวกมันแฮ็กเปิดประตูออกมาและยิงคุณจากด้านหลัง"
                    ]
                },
                {
                    title: "Mission 4: สารเคมีมรณะ",
                    text: "ตู้ถัดไปเป็นห้องเก็บสารเคมีสีเขียวเรืองแสง มีรอยรั่ว",
                    choices: ["กลั้นหายใจแล้ววิ่งฝ่าไป", "หาชุดป้องกันในตู้", "ยิงกระจกหน้าต่างเพื่อระบายอากาศ", "ปีนออกนอกรถไฟเพื่อข้ามตู้นี้"],
                    correct: 3, 
                    deaths: [
                        "ตู้ยาวเกินไป คุณกลั้นหายใจไม่ไหวและสูดแก๊สพิษเข้าไปเต็มปอด",
                        "ไม่มีชุดป้องกันในตู้! คุณเสียเวลาหาจนแก๊สกัดกร่อนผิวหนังคุณ",
                        "ลมตีกลับ! ลมแรงภายนอกพัดแก๊สพิษอัดใส่หน้าคุณแรงกว่าเดิม",
                        null
                    ]
                },
                {
                    title: "Mission 5: รองหัวหน้า",
                    text: "หัวขบวนรถไฟ คุณเจอ 'รองหัวหน้า' ขวางทางอยู่ มันถือปืนลูกซอง",
                    choices: ["วิ่งชาร์จเข้าไป", "ยิงวัดระยะไกล", "ปามีดใส่", "หลบหลังเบาะแล้วปาระเบิด"],
                    correct: 1, 
                    deaths: [
                        "ระยะประชิดคือระยะสังหารของลูกซอง ตัวคุณขาดครึ่งท่อนทันที",
                        null,
                        "มีดปาไม่ถึงตัว รองหัวหน้ายิงสวน กระสุนลูกซองกระจายเต็มร่างคุณ",
                        "พื้นที่แคบเกินไป เบาะกันแรงระเบิดไม่ได้ คุณตายพร้อมกับศัตรู"
                    ]
                }
            ]
        },
        {
            title: "STAGE 7: THE LAB (ห้องทดลองเคลื่อนที่)",
            missions: [
                {
                    title: "Mission 1: ทางเลือกศีลธรรม",
                    text: "รถไฟเทียบท่าที่ฐานลับในภูเขา คุณลอบเข้าไปในโซนห้องทดลอง พบนักวิทยาศาสตร์กำลังทดลองมนุษย์",
                    choices: ["ช่วยตัวประกัน", "ฆ่านักวิทยาศาสตร์ให้หมด", "แอบผ่านไปเงียบๆ", "วางระเบิดห้องทดลอง"],
                    correct: 2, 
                    deaths: [
                        "ตัวประกันตกใจและกรีดร้อง ยามหน้าห้องวิ่งเข้ามาและยิงคุณ",
                        "เสียงปืนดังลั่นฐานทัพ คุณถูกล้อมจับและกลายเป็นหนูทดลองคนต่อไป",
                        null,
                        "ระเบิดห้องทดลองทำให้ระบบเตือนภัยทำงาน ฐานทัพปิดตายขังคุณไว้ข้างใน"
                    ]
                },
                {
                    title: "Mission 2: สแกนชีวภาพ",
                    text: "คุณต้องผ่านประตูสแกนลายนิ้วมือ มีมือศพนักวิจัยนอนอยู่ข้างๆ",
                    choices: ["ลากศพมาแปะนิ้ว", "ตัดนิ้วศพมาใช้", "แฮ็กระบบด้วยคอมพิวเตอร์แถวนั้น", "ระเบิดประตู"],
                    correct: 1, 
                    deaths: [
                        "ศพหนักเกินไปและเริ่มแข็งตัว คุณเสียเวลานานจนยามเดินมาตรวจพบ",
                        null,
                        "ระบบรักษาความปลอดภัยซับซ้อนเกินกว่าจะแฮ็กได้ในเวลาสั้นๆ ระบบปล่อยแก๊สพิษ",
                        "ประตูห้องแล็บกันระเบิด แรงระเบิดเด้งกลับมาหาคุณเอง"
                    ]
                },
                {
                    title: "Mission 3: หมาป่าจักรกล",
                    text: "ในห้องเก็บตัวอย่าง มีหมาป่าดัดแปลงพันธุกรรม (Cyborg Wolves) 3 ตัวถูกปล่อยออกมาล่าคุณ",
                    choices: ["วิ่งหนีสุดชีวิต", "ใช้ปืนยิงหัวมัน", "ใช้มีดสู้ระยะประชิด", "ปาระเบิดเสียง (Flashbang)"],
                    correct: 3, 
                    deaths: [
                        "คุณวิ่งหนีสัตว์ 4 ขาไม่ทัน มันกระโจนกัดคอคุณจากด้านหลัง",
                        "กะโหลกพวกมันเสริมไทเทเนียม กระสุนแฉลบออกหมด มันขย้ำคุณเละ",
                        "มีดสู้กรงเล็บจักรกลไม่ได้ คุณถูกฉีกแขนขาดในพริบตา",
                        null
                    ]
                },
                {
                    title: "Mission 4: เลเซอร์เคลื่อนที่",
                    text: "คุณเจอกับกับดักเลเซอร์ที่เคลื่อนที่ได้ในโถงทางเดิน",
                    choices: ["วิ่งฝ่าไปตอนมันเปิดช่อง", "ใช้ปืนยิงตัวกำเนิดเลเซอร์", "ใช้ระเบิดควันให้เห็นลำแสงชัดๆ", "เดินถอยหลังกลับ"],
                    correct: 1, 
                    deaths: [
                        "เลเซอร์เปลี่ยนรูปแบบการเคลื่อนที่กะทันหัน ร่างคุณถูกตัดเป็นชิ้นๆ",
                        null,
                        "ควันทำให้เห็นลำแสงชัดขึ้น แต่คุณก็ยังผ่านไปไม่ได้อยู่ดี สุดท้ายยามตามมาทัน",
                        "ทางที่คุณเดินผ่านมาถูกปิดล็อคหมดแล้ว คุณติดกับดักและขาดอากาศหายใจ"
                    ]
                },
                {
                    title: "Mission 5: ลิฟต์แก้ว",
                    text: "ถึงลิฟต์แก้วที่จะพาไปหา 'ผู้นำองค์กร' แต่ลิฟต์ล็อคอยู่",
                    choices: ["ยิงสายสลิงลิฟต์", "ปีนช่องชาร์ปข้างลิฟต์", "ระเบิดประตูกระจก", "ใช้รหัสที่ได้จากห้องทดลอง"],
                    correct: 3, 
                    deaths: [
                        "ยิงสายสลิงทำให้ตัวลิฟต์ร่วงลงไปข้างล่างพร้อมกับตัวคุณ ตายคาที่",
                        "ช่องชาร์ปมีเซ็นเซอร์จับความเคลื่อนไหว ใบพัดระบายอากาศสับร่างคุณ",
                        "กระจกกันกระสุนและกันระเบิด แรงอัดกระแทกคุณบาดเจ็บสาหัสและถูกจับ",
                        null
                    ]
                }
            ]
        },
        {
            title: "STAGE 8: THE ARMORY (คลังอาวุธ)",
            missions: [
                {
                    title: "Mission 1: จักเกอร์นอท",
                    text: "คุณเข้าสู่โซนคลังอาวุธ ศัตรูที่นี่ใส่ชุดเกราะเต็มยศ (Juggernaut) ถือปืนกลหนัก",
                    choices: ["ดวลปืนซึ่งหน้า", "วิ่งล่อให้มันตามมาแล้วยิงถังแก๊ส", "ใช้มีดลอบสังหาร", "ปาระเบิดใส่เกราะ"],
                    correct: 1, 
                    deaths: [
                        "ปืนพกของคุณเจาะเกราะมันไม่เข้า ปืนกลหมุนของมันฉีกร่างคุณเป็นชิ้นๆ",
                        null,
                        "คุณเข้าไม่ถึงตัวมัน มันจับคอคุณหักด้วยมือเดียว",
                        "ชุดเกราะ Juggernaut ออกแบบมาเพื่อกันระเบิด มันเดินฝ่าควันมายิงคุณตาย"
                    ]
                },
                {
                    title: "Mission 2: คลังแสงย่อย",
                    text: "กระสุนคุณหมดเกลี้ยง คุณเจอคลังแสงย่อย แต่มีระเบิดกับดักขวางอยู่",
                    choices: ["กระโดดข้ามลวดสะดุด", "ใช้มีดตัดลวด", "เดินอ้อมไปหาทางเข้าอื่น", "โยนของใส่ให้ระเบิดทำงาน"],
                    correct: 2, 
                    deaths: [
                        "คุณกระโดดไม่พ้น ขาไปเกี่ยวกับลวดสะดุด ระเบิดทำงานทันที",
                        "กับดักนี้เป็นแบบ 'ห้ามตัด' การตัดสายไฟทำให้วงจรครบและระเบิดทันที",
                        null,
                        "แรงระเบิดรุนแรงเกินไป คลังแสงถล่มลงมาทับคุณตาย"
                    ]
                },
                {
                    title: "Mission 3: รถถังจิ๋ว",
                    text: "คุณได้ปืน RPG มา แต่มีศัตรูขับรถถังขนาดเล็กออกมาขวางทาง",
                    choices: ["ยิง RPG ใส่ล้อตีนตะขาบ", "ยิง RPG ใส่ป้อมปืน", "วิ่งเข้าไปวางระเบิดใต้ท้องรถ", "หนี"],
                    correct: 1, 
                    deaths: [
                        "ล้อตีนตะขาบพังแต่ป้อมปืนยังหมุนได้ มันยิงสวนคุณด้วยกระสุนระเบิด",
                        null,
                        "คุณวิ่งเข้าไปไม่ถึงตัว ปืนกลร่วมแกนยิงคุณตายก่อน",
                        "ไม่มีทางหนีในอุโมงค์นี้ รถถังยิงไล่หลังคุณ ร่างแหลกเหลว"
                    ]
                },
                {
                    title: "Mission 4: หน่วยปราบจลาจล",
                    text: "ทางเดินแคบลง ศัตรูตั้งโล่ Riot Shield ขวางทาง 5 นาย",
                    choices: ["ยิงอัดโล่", "ปาระเบิดข้ามหัวพวกมัน", "วิ่งชาร์จ", "ยอมจำนน"],
                    correct: 1, 
                    deaths: [
                        "โล่กันกระสุนได้สมบูรณ์แบบ กระสุนหมดและคุณถูกรุมกระบองทุบตาย",
                        null,
                        "คุณวิ่งชนกำแพงโล่ เหมือนวิ่งชนกำแพงเหล็ก คุณถูกจับกุมและสังหาร",
                        "คุณทิ้งปืน แต่พวกมันไม่ปรานี ระดมยิงใส่คุณทันที"
                    ]
                },
                {
                    title: "Mission 5: ทำลายล้าง",
                    text: "คุณต้องวางระเบิด C4 เพื่อทำลายคลังอาวุธทั้งหมด แต่เวลามีน้อย",
                    choices: ["วางที่กองกระสุน", "วางที่เสาตอม่อหลัก", "วางที่ประตูทางเข้า", "วางที่ระบบดับเพลิง"],
                    correct: 0, 
                    deaths: [
                        null,
                        "เสาตอม่อแข็งแรงเกินไป คลังแสงไม่ถล่ม และศัตรูกลับมาฆ่าคุณ",
                        "ประตูพังแต่คลังอาวุธยังอยู่ ศัตรูใช้อาวุธเหล่านั้นไล่ล่าคุณ",
                        "ระบบดับเพลิงพังแต่นั่นไม่ได้ช่วยทำลายอาวุธ คุณหนีไม่ทัน"
                    ]
                }
            ]
        },
        {
            title: "STAGE 9: THE INNER SANCTUM (เขตหวงห้าม)",
            missions: [
                {
                    title: "Mission 1: คู่แฝดมรณะ (ระยะไกล)",
                    text: "ใกล้ถึงตัวหัวหน้าแล้ว คุณพบกับ 'Silent Twins' คู่แฝดนักฆ่าที่ใช้ดาบซามูไร",
                    choices: ["ใช้ปืนยิงจากระยะไกล", "ใช้มีดสู้ระยะประชิด", "ปาระเบิดใส่", "วิ่งแยกพวกมันออกจากกัน"],
                    correct: 0, 
                    deaths: [
                        null,
                        "คุณคิดผิดที่เอามีดไปสู้กับดาบซามูไร แขนคุณขาดในดาบเดียว",
                        "พวกมันรวดเร็วมาก ปัดระเบิดกลับมาหาคุณ ระเบิดตูมใส่หน้า",
                        "การแยกพวกมันทำให้คุณถูกต้อนเข้ามุม และถูกรุมสังหารจากสองทิศทาง"
                    ]
                },
                {
                    title: "Mission 2: คู่แฝดมรณะ (ระยะประชิด)",
                    text: "ฝาแฝดปัดกระสุนได้! พวกมันพุ่งเข้ามา",
                    choices: ["ยิงที่ขา", "เปลี่ยนเป็นใช้มีดรับดาบ", "ปาระเบิดลงพื้นแล้วกระโดดหนี", "ใช้ปืนทุบ"],
                    correct: 2, 
                    deaths: [
                        "พวกมันกระโดดหลบกระสุนและฟันคอคุณขาด",
                        "แรงปะทะจากดาบหนักหน่วงเกินไป มีดคุณหักและดาบผ่าร่างคุณ",
                        null,
                        "คุณยกปืนขึ้นทุบ แต่ช้ากว่าดาบ แขนและปืนของคุณร่วงลงพื้นพร้อมกัน"
                    ]
                },
                {
                    title: "Mission 3: ป้อมปืนคู่",
                    text: "ประตูห้องของ 'ผู้อยู่เบื้องหลัง' อยู่ตรงหน้า แต่มีป้อมปืนกลอัตโนมัติ 2 ป้อม",
                    choices: ["วิ่งสไลด์เข้าไป", "ใช้ระเบิดควันบังตาเซ็นเซอร์", "แฮ็กระบบ", "ยิงแลก"],
                    correct: 1, 
                    deaths: [
                        "ความเร็วมนุษย์สู้คอมพิวเตอร์ไม่ได้ คุณถูกยิงพรุนกลางอากาศ",
                        null,
                        "แผงควบคุมอยู่ที่ตัวป้อม คุณเข้าไปไม่ถึงและถูกยิงตาย",
                        "ปืนพกสู้ปืนกลหนักไม่ได้ คุณแพ้ราบคาบ"
                    ]
                },
                {
                    title: "Mission 4: รหัสผ่านสุดท้าย",
                    text: "คุณต้องใส่รหัสผ่านประตูชั้นสุดท้าย",
                    choices: ["ปืน", "มีด", "แก้วไวน์", "ซิการ์"],
                    correct: 2, 
                    deaths: [
                        "รหัสผิด! ยมทูตไม่ได้ถือปืนตลอดเวลา ระบบกับดักเลเซอร์ทำงาน",
                        "รหัสผิด! ยมทูตใช้มีดแต่ไม่ได้ถือไว้ตลอด ระบบปล่อยแก๊สพิษ",
                        null,
                        "รหัสผิด! นั่นมันตัวร้ายในหนังเรื่องอื่น พื้นห้องเปิดออกทิ้งคุณลงบ่อหนาม"
                    ]
                },
                {
                    title: "Mission 5: กับดักภาพลวงตา",
                    text: "คุณเข้ามาในห้องโถงใหญ่ ไม่พบใคร แต่มีจอภาพขนาดยักษ์เปิดขึ้น หน้าของ 'ชายปริศนา' ปรากฏ",
                    choices: ["ยิงจอภาพทิ้ง", "ตะโกนด่า", "ยืนฟังสิ่งที่มันจะพูด", "มองหาที่กำบังทันที"],
                    correct: 3, 
                    deaths: [
                        "กระสุนกระทบจอภาพระเบิดใส่หน้าคุณ มันเป็นกับดักระเบิด!",
                        "เสียงตะโกนของคุณกระตุ้นเซ็นเซอร์เสียง ปืนกลที่ซ่อนอยู่ทำงาน",
                        "ขณะที่คุณยืนฟัง พื้นห้องเปิดออก คุณตกลงไปในบ่อกรด",
                        null
                    ]
                }
            ]
        },
        {
            title: "STAGE 10: THE ARCHITECT (ความจริงเปิดเผย)",
            missions: [
                {
                    title: "Mission 1: ตัวตนที่แท้จริง",
                    text: "ชายปริศนาปรากฏตัวตัวจริง! เขาอยู่ในชุดเกราะ Exosuit ขนาดใหญ่ และประกาศนามว่า 'สถาปนิก' (The Architect) ผู้ชักใยยมทูต!",
                    choices: ["ยิงที่ศีรษะ", "ยิงที่ถังพลังงานด้านหลัง", "วิ่งเข้าไปต่อย", "ปาระเบิดใส่หน้า"],
                    correct: 1, 
                    deaths: [
                        "หมวกเกราะหนาเกินไป กระสุนเด้งออกหมด เขาหัวเราะและยิงสวน",
                        null,
                        "หมัดเปล่าๆ ทำอะไรเกราะเหล็กไม่ได้ เขาจับคุณบีบเละคามือ",
                        "ระบบป้องกันอัตโนมัติยิงระเบิดทิ้งกลางอากาศ แรงระเบิดทำร้ายคุณเอง"
                    ]
                },
                {
                    title: "Mission 2: ดาบพลังงาน",
                    text: "Exosuit เสียหาย แต่เขายังไม่ตาย เขาชักดาบพลังงานออกมาพุ่งใส่คุณ",
                    choices: ["ใช้มีดรับดาบ", "กลิ้งหลบไปด้านข้าง", "รับด้วยมือเปล่า", "ยิงสวน"],
                    correct: 1, 
                    deaths: [
                        "ดาบพลังงานความร้อนสูงหลอมละลายมีดคุณและผ่าร่างคุณในดาบเดียว",
                        null,
                        "มือคุณขาดหายไปทันทีที่สัมผัสใบดาบ",
                        "คุณเหนี่ยวไกไม่ทัน ความเร็วของชุด Exosuit เร็วกว่ามาก"
                    ]
                },
                {
                    title: "Mission 3: วิกฤตขีปนาวุธ",
                    text: "เขาล้มลง แต่กดรีโมทเริ่มระบบยิงขีปนาวุธทำลายเมือง เวลาเหลือ 30 วินาที",
                    choices: ["รีบวิ่งไปที่แผงควบคุม", "ยิงซ้ำให้ตายสนิทก่อน", "พยายามกู้ระเบิดที่ตัวขีปนาวุธ", "โทรขอความช่วยเหลือ"],
                    correct: 0, 
                    deaths: [
                        null,
                        "คุณเสียเวลากับคนที่กำลังจะตาย ขีปนาวุธถูกยิงออกไป เมืองถูกทำลาย",
                        "ตัวขีปนาวุธซับซ้อนเกินไป คุณกู้ไม่ทันและมันพุ่งขึ้นสู่ท้องฟ้า",
                        "ไม่มีใครช่วยคุณได้ทันใน 30 วินาที ขีปนาวุธถูกยิงออกไป"
                    ]
                },
                {
                    title: "Mission 4: Hard Reset",
                    text: "แผงควบคุมถามหารหัสยกเลิก สถาปนิกหัวเราะ 'แกไม่มีวันรู้หรอก'",
                    choices: ["บังคับให้มันบอก", "เดารหัส", "ดึงชิปประมวลผลออก", "ทำลายแผงควบคุมทิ้ง"],
                    correct: 3, 
                    deaths: [
                        "เขาสิ้นใจตายก่อนจะบอกรหัส เวลาหมดลง... ตูม!",
                        "รหัสมีความเป็นไปได้เป็นล้านล้านแบบ คุณเดาผิด ระบบล็อคถาวร",
                        "การดึงชิปทำให้ระบบจุดระเบิดฉุกเฉินทำงาน ฐานทัพระเบิดไปพร้อมกับคุณ",
                        null
                    ]
                },
                {
                    title: "Mission 5: เส้นด้ายแห่งโชคชะตา",
                    text: "แผงควบคุมพัง แต่ระบบสำรองทำงาน! คุณต้องตัดสายไฟเส้นสุดท้าย มีสี 'ดำ' กับ 'ขาว' สัญชาตญาณบอกว่า...",
                    choices: ["ตัดสีดำ", "ตัดสีขาว", "ตัดทั้งสองพร้อมกัน", "ไม่ตัด รอมัน Error"],
                    correct: 0, 
                    deaths: [
                        null,
                        "ผิดเส้น! ระบบจุดระเบิดทำงาน เมืองทั้งเมืองกลายเป็นทะเลเพลิง ภารกิจล้มเหลว",
                        "การตัดพร้อมกันทำให้ไฟลัดวงจรและจุดชนวนระเบิดทันที",
                        "มันไม่ Error แต่มัน Launch! ขีปนาวุธพุ่งออกไปทำลายโลก"
                    ]
                }
            ]
        }
    ];

    // STATE
    let currentStage = 0;
    let currentMission = 0;

    // DOM ELEMENTS
    const startScreen = document.getElementById('start-screen');
    const gameScreen = document.getElementById('game-screen');
    const gameOverScreen = document.getElementById('game-over-screen');
    const winScreen = document.getElementById('win-screen');
    const storyText = document.getElementById('story-text');
    const choicesContainer = document.getElementById('choices-container');
    const deathReason = document.getElementById('death-reason');
    const communityBtn = document.getElementById('community-btn');
    const currentStageTitle = document.getElementById('current-stage-title');
    const currentMissionTitle = document.getElementById('current-mission-title');

    // FUNCTIONS
    function startGame() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        stopSFX();
        playBGM();
        currentStage = 0;
        currentMission = 0;
        switchScreen(gameScreen);
        renderMission();
    }

    function renderMission() {
        const stageData = gameData[currentStage];
        const missionData = stageData.missions[currentMission];
        currentStageTitle.innerText = stageData.title;
        currentMissionTitle.innerText = missionData.title;
        storyText.innerText = missionData.text;
        choicesContainer.innerHTML = '';

        missionData.choices.forEach((choice, index) => {
            const btn = document.createElement('button');
            btn.className = 'choice-btn';
            btn.innerText = choice;
            btn.onclick = () => checkAnswer(index);
            choicesContainer.appendChild(btn);
        });

        gameScreen.classList.remove('fadeIn');
        void gameScreen.offsetWidth;
        gameScreen.classList.add('fadeIn');

        setTimeout(() => {
            if (currentMission === 0) currentStageTitle.focus();
            else currentMissionTitle.focus();
        }, 100);
    }

    function checkAnswer(selectedIndex) {
        const isLastMission = (currentStage === 9 && currentMission === 4);
        const missionData = gameData[currentStage].missions[currentMission];

        if (selectedIndex === missionData.correct) {
            if (isLastMission) {
                stopBGM();
                playSFX('t', () => {
                    playSFX('win');
                });
                gameWin();
            } else {
                playSFX('t');
                nextMission();
            }
        } else {
            stopBGM();
            playSFX('lost');
            gameOver(missionData.deaths[selectedIndex]);
        }
    }

    function nextMission() {
        currentMission++;
        if (currentMission >= 5) {
            currentMission = 0;
            currentStage++;
        }
        if (currentStage < 10) renderMission();
    }

    function gameOver(reason) {
        deathReason.innerText = `สาเหตุการเสียชีวิต: "${reason}"`;
        switchScreen(gameOverScreen);
        document.body.classList.add('shake-screen');
        setTimeout(() => document.body.classList.remove('shake-screen'), 500);
        setTimeout(() => document.getElementById('game-over-heading').focus(), 100);
    }

    function gameWin() {
        switchScreen(winScreen);
        setTimeout(() => document.getElementById('win-heading').focus(), 100);
    }

    function resetGame() {
        stopSFX();
        stopBGM();
        switchScreen(startScreen);
        setTimeout(() => document.getElementById('main-title-heading').focus(), 100);
    }

    function switchScreen(screen) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        screen.classList.add('active');
        // แสดงปุ่มคอมมิวนิตี้เฉพาะหน้า Start, Game Over และ Win
        if (screen === startScreen || screen === gameOverScreen || screen === winScreen) {
            communityBtn.style.display = 'block';
        } else {
            communityBtn.style.display = 'none';
        }
    }

    // --- CHEAT CODE SYSTEM ---
    let cheatInput = "";
    let cheatTimer = null;

    window.addEventListener('keydown', (e) => {
        // ดักจับการพิมพ์สูตร
        cheatInput += e.key.toLowerCase();
        
        clearTimeout(cheatTimer);
        cheatTimer = setTimeout(() => { cheatInput = ""; }, 2000);

        if (cheatInput.includes("shadow")) {
            cheatInput = "";
            activateCheat();
        }

        // เมื่อกดปุ่มใดๆ ให้หยุดเสียง Win (ตามที่ร้องขอ)
        if (winScreen.classList.contains('active')) {
            stopSFX();
        }
    });

    function activateCheat() {
        if (!gameScreen.classList.contains('active')) return;
        // ส่งไปยังคำถามข้อสุดท้าย (Stage 10, Mission 5)
        currentStage = 9;
        currentMission = 4;
        renderMission();
    }

</script>
</body>
</html>